<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:t="http://myfaces.apache.org/tomahawk">

    <t:div rendered="#{not empty conventionController.listeAnneesUniv}">

        <t:htmlTag value="i" styleClass="fa fa-user fz13 fontBlue2"/>
        <h:outputText value="#{msgs['RECHERCHECONVENTION.ETUDIANT']} : " styleClass="fontBold fontBlue2 fz13 ml5" escape="false"/>

        <p:panelGrid styleClass="panelInfos mt5 mb5 ml40">
            <p:row>
                <p:column>
                    <h:outputText styleClass="fontBold"
                                  value="#{msgs['CONVENTION.NUMETUDIANT']}" />
                </p:column>
                <p:column>
                    <h:outputText id="numeroetudiant"
                                  value="#{conventionController.etudiantRef.numEtudiant}" />
                </p:column>
            </p:row>
            <p:row>
                <p:column>
                    <h:outputText styleClass="fontBold"
                                  value="#{msgs['CONVENTION.NOM']}" />
                </p:column>
                <p:column>
                    <h:outputText id="nom"
                                  value="#{conventionController.etudiantRef.nom}   #{conventionController.etudiantRef.nomMarital}" />
                </p:column>
            </p:row>
            <p:row>
                <p:column>
                    <h:outputText styleClass="fontBold"
                                  value="#{msgs['CONVENTION.PRENOM']}" />
                </p:column>
                <p:column>
                    <h:outputText id="prenom"
                                  value="#{conventionController.etudiantRef.prenom}" />
                </p:column>
            </p:row>
        </p:panelGrid>

        <t:div
                rendered="#{conventionController.conventionExistante}">
            <t:htmlTag value="i" styleClass="fa fa-exclamation-triangle fz13 fontYellow"/>
            <h:outputText styleClass="ml5"
                          value="#{msgs['CONVENTION.ETAPE1.AVERTISSEMENT.ETUDIANT.CONVENTION_EXISTANTE']}"
                          rendered="#{welcomeController.etudiant}" />
            <h:outputText styleClass="ml5"
                          value="#{msgs['CONVENTION.ETAPE1.AVERTISSEMENT.PERSONNEL.CONVENTION_EXISTANTE']}"
                          rendered="#{!welcomeController.etudiant}" />
        </t:div>

        <t:htmlTag value="i" styleClass="fa fa-star fz13 fontBlue2 mt20"/>
        <h:outputText value="#{msgs['CONVENTION.ETAPE1.RECHERCHE.ETUDIANT.DETAIL']}" styleClass="fontBold fontBlue2 fz13 ml5" escape="false"/>

        <p:panelGrid styleClass="panelInfos mt5 mb20 ml40">
            <p:row>
                <p:column>
                    <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ETU.ADRESSE']} *"/>
                </p:column>
                <p:column>
                    <p:inputText id="mainAddress"
                                 value="#{conventionController.etudiantRef.mainAddress}"
                                 maxlength="200" required="true">
                        <p:ajax event="blur" update="@form"/>
                    </p:inputText>
                </p:column>
                <p:column>
                    <p:message for="mainAddress"/>
                </p:column>
            </p:row>
            <p:row>
                <p:column style="white-space: nowrap;" styleClass="fontBold">
                    <h:outputText value="#{msgs['CONVENTION.ETU.CODEPOSTAL']} *"/>
                </p:column>
                <p:column>
                    <p:inputText id="codePostal" maxlength="10" required="true"
                                 value="#{conventionController.etudiantRef.postalCode}"/>
                </p:column>
                <p:column>
                    <p:message for="codePostal"/>
                </p:column>
            </p:row>
            <p:row>
                <p:column>
                    <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ETU.COMMUNE']}"/>
                </p:column>
                <p:column>
                    <p:inputText id="commune" maxlength="80"
                                 value="#{conventionController.etudiantRef.town}"/>
                </p:column>
                <p:column>
                    <p:message for="commune"/>
                </p:column>
            </p:row>
            <p:row>
                <p:column>
                    <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ETU.PAYS']} *"/>
                </p:column>
                <p:column>
                    <p:inputText id="pays" maxlength="50"
                                 value="#{conventionController.etudiantRef.country}"
                                 required="true">
                        <p:ajax event="blur" update="@form"/>
                    </p:inputText>
                </p:column>
                <p:column>
                    <p:message for="pays"/>
                </p:column>
            </p:row>
            <p:row>
                <p:column>
                    <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ETU.TELEPHONE']}"/>
                </p:column>
                <p:column>
                    <p:inputText id="telephone" maxlength="20" type="tel"
                                 value="#{conventionController.etudiantRef.tel}" />
                </p:column>
                <p:column>
                    <p:message for="telephone"/>
                </p:column>
            </p:row>
            <p:row>
                <p:column>
                    <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ETU.TELEPHONE.PORTABLE']}"/>
                </p:column>
                <p:column>
                    <p:inputText id="telephoneportable" maxlength="20" type="tel"
                                 value="#{conventionController.etudiantRef.portablePhone}" />
                </p:column>
                <p:column>
                    <p:message for="telephoneportable"/>
                </p:column>
            </p:row>
            <p:row>
                <p:column>
                    <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ETU.MAILPERSO']} *"/>
                </p:column>
                <p:column>
                    <p:inputText id="mailperso" required="true" maxlength="100" type="email"
                                 value="#{conventionController.etudiantRef.mailPerso}">
                        <p:ajax event="blur" update="@form"/>
                    </p:inputText>
                </p:column>
                <p:column>
                    <p:message for="mailperso"/>
                </p:column>
            </p:row>
            <p:row>
                <p:column>
                    <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ETU.MAILINSTITU']}"/>
                </p:column>
                <p:column style="word-break: break-all;">
                    <h:outputText id="mailinstitu"
                                  value="#{conventionController.etudiantRef.mail}" />
                </p:column>
                <p:column>
                    <p:message for="mailinstitu"/>
                </p:column>
            </p:row>
        </p:panelGrid>
    </t:div>

    <t:div id="panelInscription"
           rendered="#{not empty conventionController.listeAnneesUniv}">

        <t:htmlTag value="i" styleClass="fa fa-graduation-cap fz13 fontBlue2"/>
        <h:outputText value="#{msgs['CONVENTION.ETAPE1.CHOIXETUDIANT.DEMANDE']}" styleClass="fontBold fontBlue2 fz13 ml5" escape="false"/>

        <t:div styleClass="mt5 mb10 ml40">
            <h:panelGrid columns="2">
                <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ANNEE']} * " />
                <p:message id="msgChoixAnneeUniv" for="choixAnneeUniv" />
            </h:panelGrid>
            <h:selectOneMenu id="choixAnneeUniv" styleClass="customPstage fix-selectOneMenu autoWidth ml20"
                             required="true" effect="none"
                             value="#{conventionController.selectedAnneeUniv}">
                <f:selectItem itemValue="" itemLabel=""/>
                <f:selectItems value="#{conventionController.listeAnneesUniv}" />
                <p:ajax event="valueChange" onstart="PF('statusDialog').show();"
                        oncomplete="PF('statusDialog').hide();"
                        listener="#{conventionController.loadInfosEtu}"
                        update="panelInscription" />
            </h:selectOneMenu>
            <t:div id="divInscription"
                   rendered="#{not empty conventionController.selectedAnneeUniv and !conventionController.blocageCreationEtpOrpheline
			            and !conventionController.blocageAucuneInscription}">
                <t:div rendered="#{!conventionController.etudiantSupUneEtape}">
                    <h:panelGrid columns="2" cellpadding="5">
                        <h:outputText styleClass="fontBold" for="etape"
                                      value="#{msgs['CONVENTION.VOTREETAPE']} : " />
                        <h:outputText id="etape" styleClass="ml5"
                                      value="#{conventionController.etudiantRef.theCodeEtape} - #{conventionController.etudiantRef.theEtape}" />

                        <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.VOTREUFR']} : " />
                        <h:outputText id="ufr" styleClass="ml5"
                                      value="#{conventionController.etudiantRef.thecodeUFR} - #{conventionController.etudiantRef.theUfr}" />
                    </h:panelGrid>

                    <t:div rendered="#{conventionController.etudiantUnElp || conventionController.etudiantSupUnElp}">
                        <h:outputText styleClass="fontBold" for="elp1" value="#{msgs['CONVENTION.ELP']} : " />
                        <h:selectOneMenu id="choixElp1" effect="none" styleClass="customPstage fix-selectOneMenu autoWidth"
                                         value="#{conventionController.selectedCodeElp}" required="true">
                            <f:selectItem itemValue="" />
                            <f:selectItems value="#{conventionController.listeELPEtapesSelectItems}" />
                            <p:ajax event="valueChange"
                                    listener="#{conventionController.rechargeElp}" update="elp1" />
                        </h:selectOneMenu>
                        <h:outputText id="elp1"
                                      value="#{conventionController.etudiantRef.theCodeElp} - #{conventionController.etudiantRef.theLibElp} - #{conventionController.etudiantRef.theCreditECTS} crédit(s)" />

                    </t:div>
                    <p:message for="choixElp1"/>
                </t:div>

                <t:div styleClass="mt5" rendered="#{conventionController.etudiantSupUneEtape}">
                    <h:panelGrid columns="2">
                        <h:outputText styleClass="fontBold"
                                      value="#{msgs['CONVENTION.VOTREETAPE']} *" />
                        <p:message id="msgEtapes" for="choixEtape"/>
                    </h:panelGrid>
                    <h:selectOneMenu id="choixEtape" effect="none" required="true" styleClass="customPstage fix-selectOneMenu autoWidth ml20"
                                     value="#{conventionController.selectedCodeEtape}">
                        <f:selectItem itemValue="" />
                        <f:selectItems
                                value="#{conventionController.listeEtapesEtudiant}" />
                        <p:ajax event="valueChange"
                                listener="#{conventionController.rechargeUfr}"
                                update="msgEtapes,ufrs,panelElp" />
                    </h:selectOneMenu>
                    <p:outputPanel id="ufrs" styleClass="mt5">
                        <t:div rendered="#{conventionController.choixEtape}">
                            <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.VOTREUFR']} : " />
                            <h:outputText styleClass="ml5" value="#{conventionController.etudiantRef.thecodeUFR} - #{conventionController.etudiantRef.theUfr}" />
                        </t:div>
                    </p:outputPanel>

                    <p:outputPanel id="panelElp">
                        <t:div rendered="#{conventionController.etudiantUnElp}" styleClass="mt5">
                            <h:outputText styleClass="fontBold" for="panelElp"
                                          value="#{msgs['CONVENTION.ELP']} : " />
                            <h:outputText
                                    value="#{conventionController.etudiantRef.theCodeElp} - #{conventionController.etudiantRef.theLibElp} - #{conventionController.etudiantRef.theCreditECTS} crédit(s)" />
                        </t:div>
                        <t:div rendered="#{conventionController.etudiantSupUnElp}" styleClass="mt5">
                            <h:panelGrid columns="2">
                                <h:outputText styleClass="fontBold" for="choixElp2" value="#{msgs['CONVENTION.ELP']} : " />
                                <p:message for="choixElp2"/>
                            </h:panelGrid>
                            <h:selectOneMenu id="choixElp2" effect="none" styleClass="customPstage fix-selectOneMenu"
                                             value="#{conventionController.selectedCodeElp}" required="true">
                                <f:selectItem itemValue="" />
                                <f:selectItems value="#{conventionController.listeELPEtapesSelectItems}" />
                                <p:ajax event="valueChange"
                                        listener="#{conventionController.rechargeElp}" />
                            </h:selectOneMenu>
                        </t:div>
                    </p:outputPanel>
                </t:div>

                <t:div styleClass="mt10">
                    <h:panelGrid columns="2">
                        <h:outputText styleClass="fontBold" escape="false"
                                      value="#{msgs['CONVENTION.CREERCONVENTION.ETAPE.VOLUME_HORAIRE']} * " />
                        <p:message for="volumeHoraireFormation"/>
                    </h:panelGrid>
                    <p:inputText id="volumeHoraireFormation" styleClass="autoWidth ml20" required="true"
                                 value="#{conventionController.convention.volumeHoraireFormation}"
                                 validatorMessage="#{requiredMessageController.superieurA0}">
                        <f:validator binding="#{entierValidator}" />
                    </p:inputText>
                    <t:div styleClass="fz09" rendered="#{not empty conventionController.etudiantRef.volumeHoraireFormation
                    and conventionController.etudiantRef.volumeHoraireFormation != '0'}">
                        <t:htmlTag value="i" styleClass="fa fa-exclamation-circle fontBlue2 mrf5" />
                        <h:outputText value="#{msgs['CONVENTION.CREERCONVENTION.ETAPE.VOLUME_HORAIRE.INFO']} (#{conventionController.etudiantRef.volumeHoraireFormation})" />
                    </t:div>
                </t:div>
            </t:div>
            <p:message for="etape" escape="false"/>

            <t:div style="margin:10px;"
                   rendered="#{not empty conventionController.selectedAnneeUniv and conventionController.blocageCreationEtpOrpheline}">
                <t:htmlTag value="i" styleClass="fa fa-ban fontRed"/>
                <h:outputText styleClass="ml5 fontRed" escape="false"
                              value="#{msgs['CONVENTION.CREERCONVENTION.ETAPE.NONRATTACHE']}" />
            </t:div>

            <t:div style="margin:10px;"
                   rendered="#{not empty conventionController.selectedAnneeUniv and conventionController.blocageAucuneInscription}">
                <t:htmlTag value="i" styleClass="fa fa-ban fontRed"/>
                <h:outputText styleClass="ml5 fontRed" escape="false"
                              value="#{msgs['CONVENTION.CREERCONVENTION.ETAPE.AUCUNE_INSCRIPTION_PAYEE']}" />
            </t:div>
        </t:div>
    </t:div>
    <t:div styleClass="textCenter mt20 mb30">
        <t:div rendered="#{empty conventionController.listeAnneesUniv}">
            <t:htmlTag value="i" styleClass="fa fa-ban fz16 fontRed"/>
            <h:outputText styleClass="ml5 fontRed fz16"
                          value="#{msgs['CONVENTION.CREERCONVENTION.AUCUNE_INSCRIPTION']}" />
        </t:div>
        <p:commandButton id="confirmForm" value="#{msgs['FORM.VALIDER']}"
                         update="@form" styleClass="fontGreen"
                         action="#{conventionController.goToCreerConventionCtrlInfosEtu}"
                         rendered="#{not empty conventionController.listeAnneesUniv}" />
    </t:div>
    <t:div styleClass="mt20 mb20">
        <p:commandButton value="#{msgs['CONVENTION.REVENIR.LISTE.ETU']}"
                         immediate="true" update="@form" icon="fa fa-angle-left"
                         rendered="#{conventionController.etudiantTrouves}">
            <f:setPropertyActionListener
                    value="_creerConventionEtape1ListeEtudiant"
                    target="#{sessionController.creationConventionEtape1CurrentPage}" />
        </p:commandButton>
        <p:commandButton value="#{msgs['CONVENTION.RECHERCHER.AUTREETU']}"
                         immediate="true" update="@form" styleClass="ml5"
                         icon="fa fa-angle-double-left"
                         rendered="#{welcomeController.personnel}">
            <f:setPropertyActionListener
                    value="_creerConventionEtape1RechercheEtudiant"
                    target="#{sessionController.creationConventionEtape1CurrentPage}" />
        </p:commandButton>
    </t:div>
</ui:composition>