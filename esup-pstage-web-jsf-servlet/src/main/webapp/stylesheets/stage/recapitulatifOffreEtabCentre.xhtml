<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:t="http://myfaces.apache.org/tomahawk"
                xmlns:p="http://primefaces.org/ui"
                template="/stylesheets/_definedStageTemplate.xhtml">
    <ui:define name="content">
        <p:panel>
            <f:facet name="header">
                <h:outputText value="#{msgs['OFFRE.RECAPITULATIF']}" />
            </f:facet>
            <h:panelGrid
                    style="width:800px;position:relative;margin-left:100px;margin-right:auto;">
                <t:div rendered="#{empty offreController.currentOffre}">
                    <h:outputText value="#{msgs['OFFRE.GESTION.AUCUNEOFFRESEL']}" />
                </t:div>
                <h:form>
                    <h:panelGrid>
                        <p:commandLink id="editoffre"
                                       action="#{offreController.editPdfOffre}">
                            <h:graphicImage alt="#{msgs['FORM.IMPRIMER']}"
                                            value="../../media/images/printer.png" />
                            <h:outputText value="#{msgs['OFFRE.GESTION.IMPRESSION']}"
                                          escape="false" />
                        </p:commandLink>
                    </h:panelGrid>

                    <t:div rendered="#{not empty offreController.currentOffre}">
                        <t:div
                                rendered="#{welcomeController.superAdmin || welcomeController.admin || welcomeController.writer || welcomeController.reader}">
                            <!-- 							<p:outputPanel ajaxRendered="true"> -->
                            <fieldset>
                                <legend>
                                    <h:outputText value="#{msgs['OFFRE.GESTION.CENTREGESTION']} " />

                                    <h:commandLink id="modifCentre"
                                                   rendered="#{welcomeController.superAdmin || welcomeController.admin || welcomeController.writer}"
                                                   action="#{offreController.goToModificationOffreEtabCentre}"
                                                   disabled="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}">
                                        <h:graphicImage alt="#{msgs['FORM.MODIFIER']}"
                                                        value="../../media/images/edit.png"
                                                        rendered="#{offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        <h:graphicImage alt="#{msgs['FORM.MODIFIER']}"
                                                        value="../../media/images/edit_block.png"
                                                        rendered="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        <f:setPropertyActionListener
                                                value="recapitulatifOffreEtabCentre"
                                                target="#{offreController.retour}" />
                                        <f:setPropertyActionListener value="#{3}"
                                                                     target="#{offreController.typeAjoutModifOffre}" />
                                        <p:tooltip value="#{msgs['FORM.MODIFIER']}"
                                                   rendered="#{offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        <p:tooltip value="#{msgs['OFFRE.ERREUR.NOMODIF']}"
                                                   rendered="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                    </h:commandLink>
                                </legend>
                                <h:outputText
                                        value="(#{offreController.currentOffre.centreGestion.idCentreGestion}) #{offreController.currentOffre.centreGestion.nomCentre}"
                                        rendered="#{not empty offreController.currentOffre.centreGestion}" />
                            </fieldset>

                            <t:htmlTag value="div" style="height: 10px;" />

                            <fieldset>
                                <legend>
                                    <h:outputText value="#{msgs['OFFRE.GESTION.ETABLISSEMENT']} " />
                                    <h:commandLink id="modifEtab"
                                                   action="#{offreController.goToModificationOffreEtabCentre}"
                                                   rendered="#{welcomeController.superAdmin || welcomeController.admin || welcomeController.writer}"
                                                   disabled="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}">
                                        <h:graphicImage alt="#{msgs['FORM.MODIFIER']}"
                                                        value="../../media/images/edit.png"
                                                        rendered="#{offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        <h:graphicImage alt="#{msgs['FORM.MODIFIER']}"
                                                        value="../../media/images/edit_block.png"
                                                        rendered="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        <f:setPropertyActionListener
                                                value="recapitulatifOffreEtabCentre"
                                                target="#{offreController.retour}" />
                                        <f:setPropertyActionListener value="#{3}"
                                                                     target="#{offreController.typeAjoutModifOffre}" />
                                        <f:setPropertyActionListener value="_modificationOffreEtape04DetailsEtab"
                                                                     target="#{sessionController.modificationOffreCurrentPage}" />
                                        <p:tooltip value="#{msgs['FORM.MODIFIER']}"
                                                   rendered="#{offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        <p:tooltip value="#{msgs['OFFRE.ERREUR.NOMODIF']}"
                                                   rendered="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                    </h:commandLink>
                                </legend>
                                <ui:include src="/stylesheets/_commun/_detailsOffreEtab.xhtml" />
                            </fieldset>

                            <t:htmlTag value="div" style="height: 20px;" />

                            <fieldset>
                                <legend>
                                    <h:outputText value="#{msgs['OFFRE.GESTION.DETAILS']} " />
                                    <h:commandLink id="modif"
                                                   action="#{offreController.goToModificationOffreEtabCentre}"
                                                   rendered="#{welcomeController.superAdmin || welcomeController.admin || welcomeController.writer}"
                                                   disabled="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}">
                                        <h:graphicImage alt="#{msgs['FORM.MODIFIER']}"
                                                        value="../../media/images/edit.png"
                                                        rendered="#{offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        <h:graphicImage alt="#{msgs['FORM.MODIFIER']}"
                                                        value="../../media/images/edit_block.png"
                                                        rendered="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        <f:setPropertyActionListener
                                                value="recapitulatifOffreEtabCentre"
                                                target="#{offreController.retour}" />
                                        <f:setPropertyActionListener value="#{3}"
                                                                     target="#{offreController.typeAjoutModifOffre}" />
                                        <f:setPropertyActionListener value="_modificationOffreEtape1"
                                                                     target="#{sessionController.modificationOffreCurrentPage}" />
                                        <p:tooltip value="#{msgs['FORM.MODIFIER']}"
                                                   rendered="#{offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        <p:tooltip value="#{msgs['OFFRE.ERREUR.NOMODIF']}"
                                                   rendered="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                    </h:commandLink>
                                </legend>
                                <ui:include src="/stylesheets/_commun/_detailsOffre.xhtml" />
                            </fieldset>

                            <t:htmlTag value="div" style="height: 20px;" />

                            <t:div
                                    rendered="#{offreController.currentOffre.avecFichier || offreController.currentOffre.avecLien}">
                                <fieldset>
                                    <legend>
                                        <h:outputText
                                                value="#{msgs['OFFRE.GESTION.FICHIERLIENATTACHE']} " />
                                        <h:commandLink id="modifF"
                                                       action="#{offreController.goToModificationOffreEtabCentre}"
                                                       rendered="#{welcomeController.superAdmin || welcomeController.admin || welcomeController.writer}"
                                                       disabled="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}">
                                            <h:graphicImage alt="#{msgs['FORM.MODIFIER']}"
                                                            value="../../media/images/edit.png"
                                                            rendered="#{offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                            <h:graphicImage alt="#{msgs['FORM.MODIFIER']}"
                                                            value="../../media/images/edit_block.png"
                                                            rendered="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                            <f:setPropertyActionListener
                                                    value="recapitulatifOffreEtabCentre"
                                                    target="#{offreController.retour}" />
                                            <f:setPropertyActionListener value="#{3}"
                                                                         target="#{offreController.typeAjoutModifOffre}" />
                                            <f:setPropertyActionListener value="_modificationOffreEtape3"
                                                                         target="#{sessionController.modificationOffreCurrentPage}" />
                                            <p:tooltip value="#{msgs['FORM.MODIFIER']}"
                                                       rendered="#{offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                            <p:tooltip value="#{msgs['OFFRE.ERREUR.NOMODIF']}"
                                                       rendered="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        </h:commandLink>
                                    </legend>
                                    <ui:include src="/stylesheets/_commun/_detailsOffreFichier.xhtml" />
                                </fieldset>
                            </t:div>

                            <t:div
                                    rendered="#{(!offreController.currentOffre.avecFichier and !offreController.currentOffre.avecLien
										and offreController.currentOffre.centreGestion.codeConfidentialite==beanUtils.confidentialiteNulle.code)
										|| (welcomeController.superAdmin || welcomeController.admin || welcomeController.writer || welcomeController.reader)}">
                                <fieldset>
                                    <legend>
                                        <h:outputText value="#{msgs['OFFRE.GESTION.CONTACTS']} " />
                                        <h:commandLink id="modifC"
                                                       action="#{offreController.goToModificationOffreEtabCentre}"
                                                       rendered="#{welcomeController.superAdmin || welcomeController.admin || welcomeController.writer}"
                                                       disabled="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}">
                                            <h:graphicImage alt="#{msgs['FORM.MODIFIER']}"
                                                            value="../../media/images/edit.png"
                                                            rendered="#{offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                            <h:graphicImage alt="#{msgs['FORM.MODIFIER']}"
                                                            value="../../media/images/edit_block.png"
                                                            rendered="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                            <f:setPropertyActionListener
                                                    value="recapitulatifOffreEtabCentre"
                                                    target="#{offreController.retour}" />
                                            <f:setPropertyActionListener value="#{3}"
                                                                         target="#{offreController.typeAjoutModifOffre}" />
                                            <f:setPropertyActionListener value="_modificationOffreEtape3Contacts"
                                                                         target="#{sessionController.modificationOffreCurrentPage}" />
                                            <p:tooltip value="#{msgs['FORM.MODIFIER']}"
                                                       rendered="#{offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                            <p:tooltip value="#{msgs['OFFRE.ERREUR.NOMODIF']}"
                                                       rendered="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        </h:commandLink>

                                    </legend>
                                    <ui:include src="/stylesheets/_commun/_detailsOffreContacts.xhtml" />
                                </fieldset>
                            </t:div>
                            <!-- 							</p:outputPanel> -->

                            <t:htmlTag value="div" style="height: 20px;" />

                            <t:div>
                                <fieldset>
                                    <legend>
                                        <h:outputText value="#{msgs['OFFRE.DIFFUSION']}" />
                                    </legend>
                                    <ui:include src="/stylesheets/_commun/_detailsOffreDiffusion.xhtml" />
                                </fieldset>
                            </t:div>
                            <p:outputPanel ajaxRendered="true">
                                <h:panelGrid style="float:right;"
                                             rendered="#{!offreController.currentOffre.estSupprimee}">

                                    <p:commandLink id="suppr" update="supprOffre"
                                                   oncomplete="PF('supprOffre').show();"
                                                   rendered="#{welcomeController.superAdmin || welcomeController.admin || welcomeController.writer}"
                                                   disabled="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}">
                                        <h:graphicImage alt="#{msgs['OFFRE.SUPPRIMER']}"
                                                        value="../../media/images/delete.png"
                                                        rendered="#{offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        <h:graphicImage alt="#{msgs['OFFRE.SUPPRIMER']}"
                                                        value="../../media/images/delete_block.png"
                                                        rendered="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        <f:setPropertyActionListener value="resultatsRechercheOffre"
                                                                     target="#{offreController.retour}" />
                                        <f:setPropertyActionListener value="_supprOffreEtape1"
                                                                     target="#{sessionController.suppressionOffreCurrentPage}" />
                                        <h:outputText value=" #{msgs['OFFRE.SUPPRIMER']}" />
                                        <p:tooltip value="#{msgs['FORM.SUPPRIMER']}"
                                                   rendered="#{offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        <p:tooltip value="#{msgs['OFFRE.ERREUR.NOSUPPR']}"
                                                   rendered="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                    </p:commandLink>
                                </h:panelGrid>

                                <h:panelGrid style="float:right;">
                                    <p:commandLink id="transfert"
                                                   oncomplete="PF('panelTransfertOffre').show();"
                                                   rendered="#{welcomeController.superAdmin || welcomeController.admin || welcomeController.writer}"
                                                   disabled="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}">
                                        <h:graphicImage alt="#{msgs['OFFRE.TRANSFERT']}"
                                                        value="../../media/images/package_go.png"
                                                        rendered="#{offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        <h:graphicImage alt="#{msgs['OFFRE.TRANSFERT']}"
                                                        value="../../media/images/package_go_block.png"
                                                        rendered="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                        <h:outputText value=" #{msgs['OFFRE.TRANSFERT']}" />

                                        <p:tooltip value="#{msgs['OFFRE.ERREUR.NOTRANSFERT']}"
                                                   rendered="#{!offreController.listeCurrentIdsCentresGestionContainsIdCGCurrentOffre}" />
                                    </p:commandLink>
                                </h:panelGrid>
                                <h:panelGrid style="float:right;">
                                    <t:aliasBean alias="#{objet}"
                                                 value="#{offreController.currentOffre}">
                                        <ui:include src="/stylesheets/_commun/_updateInfos.xhtml" />
                                    </t:aliasBean>
                                </h:panelGrid>
                            </p:outputPanel>
                        </t:div>
                        <t:div
                                rendered="#{!(welcomeController.superAdmin || welcomeController.admin || welcomeController.writer || welcomeController.reader)}">
                            <h:panelGrid align="center">
                                <h:outputText value="#{offreController.currentOffre.intitule}"
                                              style="font-weight:bold;text-transform:uppercase;font-size:24px;" />
                            </h:panelGrid>
                            <h:panelGrid style="font-size:12px;width:800px;">
                                <t:div
                                        rendered="#{!offreController.currentOffre.cacherEtablissement}">
                                    <h:outputText
                                            value="#{msgs['RECHERCHEOFFRE.RECAPETUDIANT.ETAB']} " />
                                    <ui:include src="/stylesheets/_commun/_detailsOffreEtab.xhtml" />
                                    <t:htmlTag value="div" style="height: 10px;" />
                                </t:div>
                                <ui:include src="/stylesheets/_commun/_detailsOffreEtudiant.xhtml" />
                            </h:panelGrid>
                        </t:div>
                    </t:div>
                    <t:htmlTag value="div" style="height: 20px;" />
                    <h:panelGrid columns="3">
                        <h:commandButton
                                value="#{msgs['RECHERCHEOFFRE.RETOURAUXRESULTATS']}"
                                action="resultatsRechercheOffre" />
                        <t:htmlTag value="div" style="width: 100px;" />
                        <h:commandButton
                                value="#{msgs['RECHERCHEOFFRE.NOUVELLERECHERCHER']}"
                                action="#{offreController.goToRechercheOffreStage}" />
                    </h:panelGrid>
                </h:form>
            </h:panelGrid>
            <ui:include src="/stylesheets/_commun/_panelDiffusionOffre.xhtml" />
            <ui:include src="/stylesheets/_commun/_panelStopDiffusionOffre.xhtml" />
            <ui:include src="/stylesheets/_commun/_panelOffrePourvue.xhtml" />
            <ui:include src="/stylesheets/_commun/_panelTransfertOffre.xhtml" />
            <ui:include src="/stylesheets/_commun/_panelDiffusionCentreOffre.xhtml" />
            <ui:include src="/stylesheets/_commun/_panelSupprOffre.xhtml" />
        </p:panel>
    </ui:define>
</ui:composition>
