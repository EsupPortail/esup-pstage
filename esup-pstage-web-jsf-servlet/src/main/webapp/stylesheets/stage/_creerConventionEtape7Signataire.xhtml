<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:t="http://myfaces.apache.org/tomahawk">

	<p:panel
		style="width:800px;position:relative;margin-left:auto;margin-right:auto;">
		<f:facet name="header">
			<h:outputFormat value="#{msgs['CONVENTION.ETAPE7.SIGNATAIRE']}">
				<f:param
					value="#{conventionController.convention.structure.raisonSociale}" />
			</h:outputFormat>
		</f:facet>
		<h:panelGrid>
			<t:htmlTag value="div" style="height:10px;" />
			<h:outputFormat
				value="#{msgs['CONVENTION.ETAPE7.SIGNATAIRE.DEMANDE']}"
				style="font-weight:bold;"
				rendered="#{conventionController.saisieTuteurProParEtudiant}">
				<f:param
					value="#{conventionController.convention.structure.raisonSociale}" />
			</h:outputFormat>
			<t:div id="information">
				<p:message for="information">
					<ui:include src="../_commun/_messageInfoMarker.xhtml" />
				</p:message>
			</t:div>
			<p:commandButton
				rendered="#{conventionController.saisieTuteurProParEtudiant}"
				oncomplete="PF('selectSignataire').show();"
				value="#{msgs['CONVENTION.ETAPE7.SIGNATAIRE.SELECTION']}">
				<f:setPropertyActionListener value="#{0}"
					target="#{etablissementController.idContactSel}" />
				<f:setPropertyActionListener value="#{null}"
					target="#{etablissementController.contactSel}" />
				<f:setPropertyActionListener value="#{false}"
					target="#{etablissementController.afficherSelectionCentreContact}" />
			</p:commandButton>
			<t:htmlTag value="div" style="height:10px;" />
			<h:panelGrid
				rendered="#{conventionController.convention.centreGestion.presenceTuteurPro == false and conventionController.saisieTuteurProParEtudiant}">
				<h:outputText value="#{msgs['CONVENTION.ETAPE7.PASSERETAPE']}"
					escape="false" />
				<p:commandLink id="passeretape"
					action="#{conventionController.goToCreerConventionEtape8Recap}">
					<f:setPropertyActionListener value="#{null}"
						target="#{conventionController.signataireSel}" />
					<f:setPropertyActionListener value="#{null}"
						target="#{conventionController.convention.signataire}" />
					<h:outputText
						value="#{msgs['CONVENTION.ETAPE7.PASSERETAPE.SUIVANTE']}"
						escape="false" />
					<p:tooltip
						value="#{msgs['CONVENTION.ETAPE7.PASSERETAPE.SUIVANTE']}" />
				</p:commandLink>
			</h:panelGrid>
			<h:panelGrid
				rendered="#{!conventionController.saisieTuteurProParEtudiant}">
				<h:outputText
					value="#{msgs['CONVENTION.ETAPE7.PASSERETAPE.SAISIETUTEURPRONON']}"
					escape="false" />
				<p:commandLink id="passeretape2"
					action="#{conventionController.goToCreerConventionEtape8Recap}">
					<f:setPropertyActionListener value="#{null}"
						target="#{conventionController.signataireSel}" />
					<f:setPropertyActionListener value="#{null}"
						target="#{conventionController.convention.signataire}" />
					<h:outputText
						value="#{msgs['CONVENTION.ETAPE7.PASSERETAPE.SUIVANTE']}"
						escape="false" />
					<p:tooltip
						value="#{msgs['CONVENTION.ETAPE4.PASSERETAPE.SUIVANTE']}" />
				</p:commandLink>
			</h:panelGrid>
			<t:htmlTag value="div" style="height: 10px;" />
			<p:dialog id="selectSignataire" widgetVar="selectSignataire">
				<ui:include src="../_commun/_subPanelSelectContact.xhtml" />
				<h:panelGrid columns="3">
					<p:commandButton value="#{msgs['FORM.SELECTIONNER']}"
						oncomplete="PF('selectSignataire').hide();" update="opSignataire">
						<f:setPropertyActionListener
							value="#{etablissementController.contactSel}"
							target="#{conventionController.signataireSel}" />
					</p:commandButton>
					<t:htmlTag value="div" style="width: 100px;" />
					<p:commandButton value="#{msgs['FORM.CANCEL']}"
						onclick="PF('selectSignataire').hide();" />
				</h:panelGrid>
			</p:dialog>
			<p:outputPanel id="opSignataire"
				rendered="#{conventionController.saisieTuteurProParEtudiant}">
				<p:separator style="width:600px; height:2px;"
					rendered="#{not empty conventionController.signataireSel}" />
				<h:panelGrid
					rendered="#{not empty conventionController.signataireSel}">
					<h:outputText value="#{msgs['CONTACT.GESTION.CONTACTSELECT']}"
						escape="false" />
					<t:htmlTag value="div" style="width: 50px;" />
					<h:panelGrid columns="3">
						<h:outputText id="civC"
							value="#{conventionController.signataireSel.civilite.libelle} " />
						<h:outputText id="nomC"
							value="#{conventionController.signataireSel.nom} " />
						<h:outputText id="prenomC"
							value="#{conventionController.signataireSel.prenom}" />
					</h:panelGrid>
					<t:htmlTag value="div" style="width: 50px;" />
					<h:outputText id="fonctionC"
						value="#{conventionController.signataireSel.fonction}" />
					<t:htmlTag value="div" style="width: 50px;" />
					<h:outputText id="telC"
						value="#{conventionController.signataireSel.tel}" />
					<t:htmlTag value="div" style="width: 50px;" />
					<h:outputText id="faxC"
						value="#{conventionController.signataireSel.fax}" />
					<h:outputText id="mailC"
						value="#{conventionController.signataireSel.mail}" />
					<t:htmlTag value="div" style="width: 50px;" />
					<p:commandLink id="modifC" oncomplete="PF('modifContact').show();"
						update="modifContact"
						disabled="#{!(sessionController.adminPageAuthorized 
								or ((welcomeController.superAdmin || welcomeController.admin || welcomeController.writer) and empty conventionController.signataireSel.login and empty conventionController.signataireSel.mdp)
								or (sessionController.pageAuthorized and empty conventionController.signataireSel.login and empty conventionController.signataireSel.mdp)
								or (sessionController.pageAuthorized and sessionController.currentAuthContact.id==conventionController.signataireSel.id))}"
						rendered="#{((sessionController.adminPageAuthorized || sessionController.pageAuthorized ||
								welcomeController.admin || welcomeController.personnel || welcomeController.writer)
								|| (welcomeController.etudiant and ((sessionController.autoriserEtudiantAModifierEntreprise ||
								(!sessionController.autoriserEtudiantAModifierEntreprise 
								and ((empty conventionController.signataireSel.loginModif and
								conventionController.signataireSel.loginCreation==sessionController.currentLogin)
								|| (conventionController.signataireSel.loginModif==sessionController.currentLogin)))))))}">
						<f:setPropertyActionListener
							value="#{conventionController.signataireSel}"
							target="#{etablissementController.formContact}" />
						<f:setPropertyActionListener value="#{false}"
							target="#{etablissementController.afficherSelectionCentreContact}" />
						<f:setPropertyActionListener value="_modifContactEtape1"
							target="#{sessionController.modifContactCurrentPage}" />
						<h:graphicImage alt="#{msgs['FORM.MODIFIER']}"
							title="#{msgs['FORM.MODIFIER']}"
							value="../../media/images/edit.png"
							rendered="#{(sessionController.adminPageAuthorized 
								or ((welcomeController.superAdmin || welcomeController.admin || welcomeController.writer) and empty conventionController.signataireSel.login and empty conventionController.signataireSel.mdp)
								or (sessionController.pageAuthorized and empty conventionController.signataireSel.login and empty conventionController.signataireSel.mdp)
								or (sessionController.pageAuthorized and sessionController.currentAuthContact.id==conventionController.signataireSel.id))
								and ((sessionController.adminPageAuthorized || sessionController.pageAuthorized ||
								welcomeController.admin || welcomeController.personnel || welcomeController.writer)
								|| (welcomeController.etudiant and ((sessionController.autoriserEtudiantAModifierEntreprise ||
								(!sessionController.autoriserEtudiantAModifierEntreprise 
								and ((empty conventionController.signataireSel.loginModif and
								conventionController.signataireSel.loginCreation==sessionController.currentLogin)
								|| (conventionController.signataireSel.loginModif==sessionController.currentLogin)))))))}" />
						<h:graphicImage alt="#{msgs['FORM.MODIFIER']}"
							title="#{msgs['FORM.MODIFIER']}"
							value="../../media/images/edit_block.png"
							rendered="#{!(sessionController.adminPageAuthorized 
								or ((welcomeController.superAdmin || welcomeController.admin || welcomeController.writer) and empty conventionController.signataireSel.login and empty conventionController.signataireSel.mdp)
								or (sessionController.pageAuthorized and empty conventionController.signataireSel.login and empty conventionController.signataireSel.mdp)
								or (sessionController.pageAuthorized and sessionController.currentAuthContact.id==conventionController.signataireSel.id))
								and ((sessionController.adminPageAuthorized || sessionController.pageAuthorized ||
								welcomeController.admin || welcomeController.personnel || welcomeController.writer)
								|| (welcomeController.etudiant and ((sessionController.autoriserEtudiantAModifierEntreprise ||
								(!sessionController.autoriserEtudiantAModifierEntreprise 
								and ((empty conventionController.signataireSel.loginModif and
								conventionController.signataireSel.loginCreation==sessionController.currentLogin)
								|| (conventionController.signataireSel.loginModif==sessionController.currentLogin)))))))}" />
						<h:outputText value=" #{msgs['OFFRE.SELECTIONCONTACT.MODIFIER']}" />
						<p:tooltip value="#{msgs['FORM.MODIFIER']}"
							rendered="#{(sessionController.adminPageAuthorized 
								or ((welcomeController.superAdmin || welcomeController.admin || welcomeController.writer) and empty conventionController.signataireSel.login and empty conventionController.signataireSel.mdp)
								or (sessionController.pageAuthorized and empty conventionController.signataireSel.login and empty conventionController.signataireSel.mdp)
								or (sessionController.pageAuthorized and sessionController.currentAuthContact.id==conventionController.signataireSel.id))
								and ((sessionController.adminPageAuthorized || sessionController.pageAuthorized ||
								welcomeController.admin || welcomeController.personnel || welcomeController.writer)
								|| (welcomeController.etudiant and ((sessionController.autoriserEtudiantAModifierEntreprise ||
								(!sessionController.autoriserEtudiantAModifierEntreprise 
								and ((empty conventionController.signataireSel.loginModif and
								conventionController.signataireSel.loginCreation==sessionController.currentLogin)
								|| (conventionController.signataireSel.loginModif==sessionController.currentLogin)))))))}" />
						<p:tooltip value="#{msgs['CONTACT.GESTION.MODIF.CONTACTENTR']}"
							rendered="#{!(sessionController.adminPageAuthorized 
								or ((welcomeController.superAdmin || welcomeController.admin || welcomeController.writer) and empty conventionController.signataireSel.login and empty conventionController.signataireSel.mdp)
								or (sessionController.pageAuthorized and empty conventionController.signataireSel.login and empty conventionController.signataireSel.mdp)
								or (sessionController.pageAuthorized and sessionController.currentAuthContact.id==conventionController.signataireSel.id))
								and ((sessionController.adminPageAuthorized || sessionController.pageAuthorized ||
								welcomeController.admin || welcomeController.personnel || welcomeController.writer)
								|| (welcomeController.etudiant and ((sessionController.autoriserEtudiantAModifierEntreprise ||
								(!sessionController.autoriserEtudiantAModifierEntreprise 
								and ((empty conventionController.signataireSel.loginModif and
								conventionController.signataireSel.loginCreation==sessionController.currentLogin)
								|| (conventionController.signataireSel.loginModif==sessionController.currentLogin)))))))}" />
					</p:commandLink>
				</h:panelGrid>
				<t:htmlTag value="center">
					<h:commandButton style="font-size:14px; border:solid 1px;"
						action="#{conventionController.goToCreerConventionEtape8Recap}"
						rendered="#{conventionController.signataireSel != null and not empty conventionController.signataireSel}"
						value="#{msgs['FORM.VALIDER']}" />
				</t:htmlTag>
			</p:outputPanel>
		</h:panelGrid>

		<t:htmlTag value="div" style="height:30px;" />
		<h:commandButton action="creerConventionEtape6Enseignant"
			value="#{msgs['FORM.PREVIOUS']}">
			<f:setPropertyActionListener
				value="_creerConventionEtape6RechEnseignant"
				target="#{sessionController.creationConventionEtape6CurrentPage}" />
		</h:commandButton>
	</p:panel>
</ui:composition>