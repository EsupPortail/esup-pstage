<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:t="http://myfaces.apache.org/tomahawk"
                xmlns:p="http://primefaces.org/ui"
                template="/stylesheets/_definedStageTemplate.xhtml">
    <ui:define name="content">
        <p:panel>
            <f:facet name="header">
                <h:outputText value="#{msgs['CONVENTION.TITRE.DETAIL']} #{conventionController.convention.idConvention} #{conventionController.convention.etudiant.nom} #{conventionController.convention.etudiant.prenom}" />
            </f:facet>
            <h:form id="formSelConvention">
                <ui:include src="_roadmapSel.xhtml" />

                <t:fieldset>
                    <t:div styleClass="mt10 ml30 mb20 block">
                        <t:div rendered="#{not empty conventionController.listeAnneesUniv}">

                            <t:div styleClass="fz16 fontBold">
                                <t:htmlTag value="i" styleClass="fa fa-edit fontBlue2"/>
                                <h:outputText value="#{msgs['CONVENTION.ETAPE1.MODIFICATION']}" styleClass="fontBold fontBlue2 ml5" escape="false"/>
                            </t:div>

                            <t:htmlTag value="div" style="height:15px;" />

                            <t:htmlTag value="i" styleClass="fa fa-user fz13 fontBlue2"/>
                            <h:outputText value="#{msgs['RECHERCHECONVENTION.ETUDIANT']} : " styleClass="fontBold fontBlue2 fz13 ml5" escape="false"/>

                            <p:panelGrid styleClass="panelInfos mt5 mb5 ml40">
                                <p:row>
                                    <p:column>
                                        <h:outputText styleClass="fontBold"
                                                      value="#{msgs['CONVENTION.NUMETUDIANT']}" />
                                    </p:column>
                                    <p:column>
                                        <h:outputText id="numeroetudiant"
                                                      value="#{conventionController.convention.etudiant.numEtudiant}" />
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <h:outputText styleClass="fontBold"
                                                      value="#{msgs['CONVENTION.NOM']}" />
                                    </p:column>
                                    <p:column>
                                        <h:outputText id="nom"
                                                      value="#{conventionController.convention.etudiant.nom}   #{conventionController.convention.etudiant.nomMarital}" />
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <h:outputText styleClass="fontBold"
                                                      value="#{msgs['CONVENTION.PRENOM']}" />
                                    </p:column>
                                    <p:column>
                                        <h:outputText id="prenom"
                                                      value="#{conventionController.convention.etudiant.prenom}" />
                                    </p:column>
                                </p:row>
                            </p:panelGrid>

                            <t:htmlTag value="i" styleClass="fa fa-star fz13 fontBlue2 mt20"/>
                            <h:outputText value="#{msgs['CONVENTION.ETAPE1.RECHERCHE.ETUDIANT.DETAIL']}" styleClass="fontBold fontBlue2 fz13 ml5" escape="false"/>

                            <p:panelGrid styleClass="panelInfos mt5 mb20 ml40">
                                <p:row>
                                    <p:column>
                                        <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ETU.ADRESSE']} *"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="mainAddress"
                                                     value="#{conventionController.convention.adresseEtudiant}"
                                                     maxlength="200" required="true">
                                            <p:ajax event="blur" update="@form"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:message for="mainAddress"/>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column style="white-space: nowrap;" styleClass="fontBold">
                                        <h:outputText value="#{msgs['CONVENTION.ETU.CODEPOSTAL']} *"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="codePostal" maxlength="10" required="true"
                                                     value="#{conventionController.convention.codePostalEtudiant}">
                                            <p:ajax event="blur" update="@form"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:message for="codePostal"/>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ETU.COMMUNE']} * "/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="commune" maxlength="80" required="true"
                                                     value="#{conventionController.convention.villeEtudiant}"/>
                                    </p:column>
                                    <p:column>
                                        <p:message for="commune"/>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ETU.PAYS']} *"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="pays" maxlength="50"
                                                     value="#{conventionController.convention.paysEtudiant}"
                                                     required="true">
                                            <p:ajax event="blur" update="@form"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:message for="pays"/>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ETU.TELEPHONE']}"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="telephone" maxlength="20"
                                                     value="#{conventionController.convention.telEtudiant}" />
                                    </p:column>
                                    <p:column>
                                        <p:message for="telephone"/>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ETU.TELEPHONE.PORTABLE']}"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="telephoneportable" maxlength="20"
                                                     value="#{conventionController.convention.telPortableEtudiant}" />
                                    </p:column>
                                    <p:column>
                                        <p:message for="telephoneportable"/>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ETU.MAILINSTITU']}"/>
                                    </p:column>
                                    <p:column>
                                        <h:outputText id="mailinstitu" maxlength="100"
                                                      value="#{conventionController.convention.etudiant.mail}" />
                                    </p:column>
                                    <p:column>
                                        <p:message for="mailinstitu"/>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column>
                                        <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ETU.MAILPERSO']} *"/>
                                    </p:column>
                                    <p:column>
                                        <p:inputText id="mailperso" required="true" maxlength="100"
                                                     value="#{conventionController.convention.courrielPersoEtudiant}">
                                            <p:ajax event="blur" update="@form"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column>
                                        <p:message for="mailperso"/>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                        </t:div>

                        <t:div id="panelInscription"
                               rendered="#{not empty conventionController.listeAnneesUniv}">

                            <t:htmlTag value="i" styleClass="fa fa-graduation-cap fz13 fontBlue2"/>
                            <h:outputText value="#{msgs['CONVENTION.ETAPE1.CHOIXETUDIANT.DEMANDE']}" styleClass="fontBold fontBlue2 fz13 ml5" escape="false"/>

                            <t:div styleClass="mt5 mb10 ml40">
                                <h:panelGrid columns="3">
                                    <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.ANNEE']}" />
                                    <h:selectOneMenu id="choixAnneeUniv" required="true" effect="none"
                                                     value="#{conventionController.selectedAnneeUniv}"
                                                     styleClass="customPstage fix-selectOneMenu">
                                        <f:selectItem itemValue="" />
                                        <f:selectItems value="#{conventionController.listeAnneesUniv}" />
                                        <p:ajax event="valueChange" onstart="PF('statusDialog').show();"
                                                oncomplete="PF('statusDialog').hide();"
                                                listener="#{conventionController.loadInfosEtu}"
                                                update="panelInscription" />
                                    </h:selectOneMenu>
                                    <p:message for="choixAnneeUniv" />
                                </h:panelGrid>

                                <t:div rendered="#{!conventionController.blocageCreationEtpOrpheline
			                and !conventionController.blocageAucuneInscription}">
                                    <t:div styleClass="mt10 mb5">
                                        <h:outputText value="Regime d'inscription : " styleClass="fontBold" />
                                        <h:outputText value="Formation Continue" rendered="#{conventionController.conventionFormationContinue}" />
                                        <h:outputText value="Formation Initiale" rendered="#{!conventionController.conventionFormationContinue}" />
                                    </t:div>

                                    <t:div rendered="#{!conventionController.etudiantSupUneEtape}">
                                        <t:div style="padding:5px;"
                                               rendered="#{conventionController.etudiantUnElp || conventionController.etudiantSupUnElp}">
                                            <h:outputText styleClass="fontBold" for="elp1" value="#{msgs['CONVENTION.ELP']}" />
                                            <h:selectOneMenu id="choixElp1" effect="none"
                                                             value="#{conventionController.selectedCodeElp}" required="true"
                                                             styleClass="customPstage fix-selectOneMenu">
                                                <f:selectItem itemValue="" />
                                                <f:selectItems
                                                        value="#{conventionController.listeELPEtapesSelectItems}" />
                                                <p:ajax event="valueChange"
                                                        listener="#{conventionController.rechargeElp}" update="elp1" />
                                            </h:selectOneMenu>
                                            <h:outputText id="elp1"
                                                          value="#{conventionController.etudiantRef.theCodeElp} - #{conventionController.etudiantRef.theLibElp} - #{conventionController.etudiantRef.theCreditECTS} crédit(s)" />

                                        </t:div>
                                        <p:message for="choixElp1"/>
                                        <h:panelGrid columns="2" cellpadding="5">
                                            <h:outputText styleClass="fontBold" for="etape"
                                                          value="#{msgs['CONVENTION.VOTREETAPE']}" />
                                            <h:outputText id="etape" styleClass="ml5"
                                                          value="#{conventionController.etudiantRef.theCodeEtape} - #{conventionController.etudiantRef.theEtape}" />

                                            <h:outputText styleClass="fontBold" value="#{msgs['CONVENTION.VOTREUFR']}" />
                                            <h:outputText id="ufr" styleClass="ml5"
                                                          value="#{conventionController.etudiantRef.thecodeUFR} - #{conventionController.etudiantRef.theUfr}" />
                                        </h:panelGrid>
                                    </t:div>

                                    <t:div rendered="#{conventionController.etudiantSupUneEtape}">
                                        <h:panelGrid columns="3" id="etapes">
                                            <h:outputText styleClass="fontBold" for="etapes"
                                                          value="#{msgs['CONVENTION.VOTREETAPE']}" />
                                            <h:selectOneMenu id="choixEtape" effect="none" required="true"
                                                             styleClass="customPstage fix-selectOneMenu"
                                                             value="#{conventionController.selectedCodeEtape}">
                                                <f:selectItem itemValue="" />
                                                <f:selectItems
                                                        value="#{conventionController.listeEtapesEtudiant}" />
                                                <p:ajax event="valueChange"
                                                        listener="#{conventionController.rechargeUfr}"
                                                        update="etapes,ufrs,elementPedago,panelElp,inputVolumeHoraire,typeNbHeuresFormation" />
                                            </h:selectOneMenu>
                                            <p:message for="choixEtape"/>
                                        </h:panelGrid>
                                        <p:outputPanel id="elementPedago" styleClass="mt5">
                                            <h:panelGrid columns="2"
                                                         rendered="#{conventionController.etudiantUnElp}">
                                                <h:outputText styleClass="fontBold" for="elementPedago"
                                                              value="#{msgs['CONVENTION.ELP']}" />
                                                <h:outputText
                                                        value="#{conventionController.etudiantRef.theCodeElp} - #{conventionController.etudiantRef.theLibElp} - #{conventionController.etudiantRef.theCreditECTS} crédit(s)" />
                                            </h:panelGrid>
                                        </p:outputPanel>
                                        <p:outputPanel id="panelElp">
                                            <h:panelGrid columns="3"
                                                         rendered="#{conventionController.etudiantSupUnElp}">
                                                <h:outputText styleClass="fontBold" for="choixElp2" value="#{msgs['CONVENTION.ELP']}" />
                                                <h:selectOneMenu id="choixElp2" effect="none"
                                                                 styleClass="customPstage fix-selectOneMenu"
                                                                 value="#{conventionController.selectedCodeElp}" required="true">
                                                    <f:selectItem itemValue="" />
                                                    <f:selectItems
                                                            value="#{conventionController.listeELPEtapesSelectItems}" />
                                                    <p:ajax event="valueChange"
                                                            listener="#{conventionController.rechargeElp}" />
                                                </h:selectOneMenu>
                                                <p:message for="choixElp2"/>
                                            </h:panelGrid>
                                        </p:outputPanel>
                                        <p:outputPanel id="ufrs" styleClass="mt5">
                                            <h:panelGrid columns="2"
                                                         rendered="#{conventionController.choixEtape}">
                                                <h:outputText styleClass="fontBold" for="ufr" value="#{msgs['CONVENTION.VOTREUFR']}" />
                                                <h:outputText
                                                        value="#{conventionController.etudiantRef.thecodeUFR} - #{conventionController.etudiantRef.theUfr}" />
                                            </h:panelGrid>
                                        </p:outputPanel>
                                    </t:div>
                                </t:div>
                                <t:div styleClass="mt5"
                                       rendered="#{!conventionController.conventionFormationContinue}">
                                    <h:panelGrid columns="2">
                                        <h:outputText styleClass="fontBold" escape="false"
                                                      value="#{msgs['CONVENTION.CREERCONVENTION.ETAPE.VOLUME_HORAIRE']} * " />
                                        <p:message for="volumeHoraireFormation"/>
                                    </h:panelGrid>

                                    <t:div styleClass="verticalAlignDiv">
                                        <p:selectOneRadio id="typeNbHeuresFormation" value="#{conventionController.defaultVolumeHoraire}"
                                                          required="true">
                                            <f:selectItem itemLabel="Plus de #{sessionController.volumeHoraireFormationParDefaut} heures" itemValue="true"/>
                                            <f:selectItem itemLabel="#{(not empty conventionController.etudiantRef.volumeHoraireFormation
                            and conventionController.etudiantRef.volumeHoraireFormation != '0') ?
                            (conventionController.defaultVolumeHoraire ? msgs['CONVENTION.CREERCONVENTION.ETAPE.VOLUME_HORAIRE.VALEUR_APOGEE'] : msgs['CONVENTION.CREERCONVENTION.ETAPE.VOLUME_HORAIRE.VALEUR_APOGEE_:'])
                            : (conventionController.defaultVolumeHoraire ? 'Saisie manuelle': 'Saisie manuelle : ')}"
                                                          itemValue="false" />
                                            <p:ajax event="click" update="inputVolumeHoraire, typeNbHeuresFormation"/>
                                        </p:selectOneRadio>

                                        <t:div id="inputVolumeHoraire">
                                            <t:htmlTag id="imgInfoVolume" value="i" styleClass="fa fa-info-circle fontBlue2 fz13"
                                                       rendered="#{!conventionController.defaultVolumeHoraire
                                       and not empty conventionController.etudiantRef.volumeHoraireFormation and conventionController.etudiantRef.volumeHoraireFormation != '0'}">
                                                <p:tooltip trackMouse="true" for="imgInfoVolume"
                                                           value="#{msgs['CONVENTION.CREERCONVENTION.ETAPE.VOLUME_HORAIRE.INFO.REMPLI']}
                                                           (#{conventionController.etudiantRef.volumeHoraireFormation})" />
                                            </t:htmlTag>
                                            <p:inputText id="volumeHoraireFormation" styleClass="autoWidth ml5" required="true"
                                                         value="#{conventionController.convention.volumeHoraireFormation}"
                                                         validatorMessage="#{requiredMessageController.superieurA0}"
                                                         rendered="#{!conventionController.defaultVolumeHoraire}">
                                                <f:validator binding="#{entierValidator}" />
                                            </p:inputText>
                                        </t:div>
                                    </t:div>
                                </t:div>

                                <p:message for="etape"/>

                                <t:div style="margin:10px;"
                                       rendered="#{conventionController.blocageCreationEtpOrpheline}">
                                    <t:htmlTag value="i" styleClass="fa fa-ban fontRed"/>
                                    <h:outputText styleClass="ml5 fontRed" escape="false"
                                                  value="#{msgs['CONVENTION.CREERCONVENTION.ETAPE.NONRATTACHE']}" />
                                </t:div>

                                <t:div style="margin:10px;"
                                       rendered="#{conventionController.blocageAucuneInscription}">
                                    <t:htmlTag value="i" styleClass="fa fa-ban fontRed"/>
                                    <h:outputText styleClass="ml5 fontRed" escape="false"
                                                  value="#{msgs['CONVENTION.CREERCONVENTION.ETAPE.AUCUNE_INSCRIPTION_PAYEE']}" />
                                </t:div>
                            </t:div>

                            <p:outputPanel id="opFCE">
                                <t:div styleClass="textCenter mb10" rendered="#{facesContext.maximumSeverity != null}">
                                    <t:htmlTag value="i" styleClass="fa fa-arrow-up fz13 fontBlue2 " />
                                    <h:outputText value="#{msgs['FORM.FORMERROR']}" styleClass="fontBold mr5 ml5"/>
                                    <t:htmlTag value="i" styleClass="fa fa-arrow-up fz13 fontBlue2 " />
                                </t:div>
                            </p:outputPanel>

                            <t:div styleClass="mt20 textCenter">
                                <p:commandButton id="modifEtudiant"
                                                 value="#{msgs['FORM.MODIFIER']}"
                                                 action="#{conventionController.modifierEtudiantDetail}"
                                                 rendered="#{not empty conventionController.convention.etudiant}"
                                                 update="@form" />
                            </t:div>
                        </t:div>

                        <t:div styleClass="textCenter mt20 mb30"
                               rendered="#{empty conventionController.listeAnneesUniv}">
                            <t:htmlTag value="i" styleClass="fa fa-ban fz16 fontRed"/>
                            <h:outputText styleClass="ml5 fontRed fz16"
                                          value="#{msgs['CONVENTION.CREERCONVENTION.AUCUNE_INSCRIPTION']}" />
                        </t:div>

                        <t:div styleClass="mt20 mb20">
                            <p:commandButton value="#{msgs['FORM.ANNULER']}"
                                             immediate="true" ajax="false"
                                             action="conventionEtape1Etudiant"
                                             icon="fa fa-angle-left" />
                        </t:div>
                    </t:div>
                </t:fieldset>
            </h:form>
        </p:panel>
    </ui:define>
</ui:composition>