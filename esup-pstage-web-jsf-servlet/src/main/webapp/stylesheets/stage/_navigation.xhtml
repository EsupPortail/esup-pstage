<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

	<h:outputStylesheet>
		ul.ui-widget-content.ui-menu-list.ui-menu-child {
		   width:250px;
		}
	</h:outputStylesheet>
	<p:menubar autoDisplay="false">

		<p:menuitem value="#{msgs['NAVIGATION.TEXT.WELCOME']}"
			action="#{welcomeController.goToAccueilStage}" icon="ui-icon-home" />

		<p:submenu label="#{msgs['MENUSTAGE.GESTIONCENTRE']}"
			icon="ui-icon-gear" id="testSubmenu"
			rendered="#{sessionController.utilisationStage and (welcomeController.personnel || welcomeController.superAdmin)}">
			<p:menuitem value="#{msgs['MENUSTAGE.LISTECENTRE']}" id="testMenu"
			styleClass="expand"
				icon="ui-icon-script" action="#{centreController.goToListeCentre}" />
		</p:submenu>

		<p:submenu label="#{msgs['MENUSTAGE.GESTIONCONVENTION']}"
			icon="ui-icon-script" style="white-space:nowrap; width:auto;"
			rendered="#{sessionController.utilisationStage and (welcomeController.personnel || welcomeController.superAdmin || welcomeController.enseignant)}">

			<p:menuitem value="#{msgs['MENUSTAGE.RECHCONVENTION']}"
				icon="ui-icon-search"
				action="#{conventionController.goToRechercheConvention}"
				rendered="#{welcomeController.personnel || welcomeController.superAdmin }" />

			<p:menuitem value="#{msgs['MENUSTAGE.CREERCONVENTION']}"
				icon="ui-icon-plus"
				action="#{conventionController.goToCreerConvention}"
				rendered="#{welcomeController.superAdmin || welcomeController.writer || welcomeController.admin}" />

			<p:menuitem value="#{msgs['MENUSTAGE.VALIDERENMASSE']}"
				icon="ui-icon-check"
				action="#{conventionController.goToValiderEnMasse}"
				rendered="#{welcomeController.superAdmin || welcomeController.writer || welcomeController.admin}" />

			<p:menuitem
				value="#{msgs['MENUSTAGE.RECHCONVENTION.ENSEIGNANTTUTEUR']}"
				icon="ui-icon-script"
				action="#{conventionController.goToRechercheConventionEnseignantTuteur}"
				rendered="#{welcomeController.enseignantTuteur}" />
		</p:submenu>

		<p:submenu label="#{msgs['MENUSTAGE.GESTIONCONVENTION']}"
			icon="ui-icon-script" style="white-space:nowrap; width:auto;"
			rendered="#{sessionController.utilisationStage and welcomeController.etudiant}">

			<p:menuitem value="#{msgs['MENUSTAGE.RECHCONVENTION.ETU']}"
				icon="ui-icon-search"
				action="#{conventionController.goToRechercheConventionEtu}" />

			<p:menuitem value="#{msgs['MENUSTAGE.CREERCONVENTION']}"
				icon="ui-icon-plus"
				action="#{conventionController.goToCreerConvention}" />
		</p:submenu>

		<p:submenu label="#{msgs['MENUSTAGE.GESTIONETAB']}"
			icon="ui-icon-bookmark" style="white-space:nowrap; width:auto;">

			<p:menuitem value="#{msgs['MENUSTAGE.RECHETAB']}"
				icon="ui-icon-search"
				action="#{rechercheController.goToRechercheEtablissementStage}">
				<f:setPropertyActionListener value="#{2}"
					target="#{rechercheController.ongletCourant}" />
				<f:setPropertyActionListener value="#{null}"
					target="#{sessionController.currentManageStructure}" />
				<f:setPropertyActionListener value="#{null}"
					target="#{etablissementController.listeServices}" />
				<f:setPropertyActionListener value="#{null}"
					target="#{etablissementController.listeContacts}" />
			</p:menuitem>

			<p:menuitem value="#{msgs['MENUSTAGE.RECHETAB.AVERIFIER']}"
				icon="ui-icon-check"
				action="#{rechercheController.goToEtablissementsAVerifier}"
				rendered="#{sessionController.moderationStructures 
				and (welcomeController.superAdmin || welcomeController.writer || welcomeController.admin)}">
				<f:setPropertyActionListener value="#{2}"
					target="#{rechercheController.ongletCourant}" />
				<f:setPropertyActionListener value="#{null}"
					target="#{sessionController.currentManageStructure}" />
				<f:setPropertyActionListener value="#{null}"
					target="#{etablissementController.listeServices}" />
				<f:setPropertyActionListener value="#{null}"
					target="#{etablissementController.listeContacts}" />
			</p:menuitem>
		</p:submenu>

		<p:submenu label="#{msgs['MENUSTAGE.GESTIONOFFRE']}"
			icon="ui-icon-clipboard" style="white-space:nowrap; width:auto;"
			rendered="#{sessionController.utilisationEntreprise}">

			<p:menuitem value="#{msgs['MENUSTAGE.RECHOFFRE']}"
				icon="ui-icon-search"
				action="#{offreController.goToRechercheOffreStage}">
				<f:setPropertyActionListener value="#{null}"
					target="#{sessionController.currentManageStructure}" />
				<f:setPropertyActionListener value="#{null}"
					target="#{etablissementController.listeServices}" />
				<f:setPropertyActionListener value="#{null}"
					target="#{etablissementController.listeContacts}" />
			</p:menuitem>

			<p:menuitem value="#{msgs['MENUSTAGE.AJOUTOFFRE']}"
				icon="ui-icon-plus"
				action="#{offreController.goToCreationOffreSelectionCentre}"
				rendered="#{!welcomeController.etudiant and (welcomeController.superAdmin || welcomeController.writer || welcomeController.admin)}">
				<f:setPropertyActionListener value="#{null}"
					target="#{sessionController.currentManageStructure}" />
				<f:setPropertyActionListener value="#{null}"
					target="#{etablissementController.listeServices}" />
				<f:setPropertyActionListener value="#{null}"
					target="#{etablissementController.listeContacts}" />
				<f:setPropertyActionListener value="#{3}"
					target="#{offreController.typeAjoutModifOffre}" />
				<f:setPropertyActionListener value="#{2}"
					target="#{rechercheController.ongletCourant}" />
			</p:menuitem>

			<p:menuitem
				value="#{msgs['MENU.OFFRESADIFFUSER']}(#{offreController.offreADiffuser})"
				icon="ui-icon-check" action="#{offreController.goToOffreADiffuser}"
				rendered="#{!welcomeController.etudiant and sessionController.moderationActive and (welcomeController.superAdmin || welcomeController.admin || welcomeController.writer)}">
				<f:setPropertyActionListener value="#{null}"
					target="#{sessionController.currentManageStructure}" />
				<f:setPropertyActionListener value="#{null}"
					target="#{etablissementController.listeServices}" />
				<f:setPropertyActionListener value="#{null}"
					target="#{etablissementController.listeContacts}" />
				<f:setPropertyActionListener value="#{3}"
					target="#{offreController.typeAjoutModifOffre}" />
				<f:setPropertyActionListener value="#{2}"
					target="#{rechercheController.ongletCourant}" />
			</p:menuitem>
		</p:submenu>

		<p:submenu label="#{msgs['MENUSTAGE.EVALUATION']}"
			icon="ui-icon-comment" style="white-space:nowrap; width:auto;"
			rendered="#{sessionController.utilisationStage
				and (welcomeController.superAdmin 
						|| not empty sessionController.droitsEvaluationEtudiantMap
						|| not empty sessionController.droitsEvaluationEnseignantMap
						|| not empty sessionController.droitsEvaluationEntrepriseMap
						|| welcomeController.enseignantTuteur
						|| welcomeController.etudiant)}">
			<p:menuitem value="#{msgs['RECHERCHEEVALUATION.TITRE']}"
				icon="ui-icon-search"
				action="#{evaluationController.goToRechercheEval}"
				rendered="#{welcomeController.superAdmin 
					|| not empty sessionController.droitsEvaluationEtudiantMap
					|| not empty sessionController.droitsEvaluationEnseignantMap
					|| not empty sessionController.droitsEvaluationEntrepriseMap}" />

			<p:menuitem value="#{msgs['MENUSTAGE.EVALUATION.VISUALISER']}"
				icon="ui-icon-script"
				action="#{evaluationController.goToRechercheEvalEns}"
				rendered="#{welcomeController.enseignantTuteur}" />

			<p:menuitem value="#{msgs['MENUSTAGE.EVALUATION.VISUALISER']}"
				icon="ui-icon-script"
				action="#{evaluationController.goToRechercheEvalEtu}"
				rendered="#{welcomeController.etudiant}" />
		</p:submenu>

		<p:menuitem value="#{msgs['MENU.GESTIONNOMENCLATURES']}"
			icon="ui-icon-newwin"
			action="#{nomenclatureController.goToGestionNomenclatures}"
			rendered="#{welcomeController.superAdmin}"/>

		<f:facet name="options">
			<p:commandButton value="#{msgs['NAVIGATION.TEXT.LOGOUT']}"
				icon="ui-icon-extlink" action="#{sessionController.logout}"
				rendered="#{sessionController.printLogout}" />
		</f:facet>
	</p:menubar>
</ui:composition>