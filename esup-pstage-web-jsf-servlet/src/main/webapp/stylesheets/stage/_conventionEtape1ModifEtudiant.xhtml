<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:t="http://myfaces.apache.org/tomahawk">

	<h:panelGrid columnClasses="paginatorData-text"
		rowClasses="paginatorData-text">
		<h:outputText value=" " id="formModifEtudiant" />
		<rich:message for="formModifEtudiant">
			<ui:include src="../_commun/_messageErrorMarker.xhtml" />
		</rich:message>
		<t:div
			rendered="#{not empty conventionController.convention.etudiant}">
			<h:panelGrid columnClasses="paginatorData-text"
				rowClasses="paginatorData-text" columns="2">
				<h:outputLabel for="numeroetudiant1"
					value="#{msgs['CONVENTION.NUMETUDIANT']}" />
				<h:outputText id="numeroetudiant1"
					value="#{conventionController.convention.etudiant.numEtudiant}" />
				<h:outputLabel for="nom1" value="#{msgs['CONVENTION.NOM']}" />
				<h:outputText id="nom1"
					value="#{conventionController.convention.etudiant.nom}   #{conventionController.convention.etudiant.nomMarital}" />
				<h:outputLabel for="prenom1" value="#{msgs['CONVENTION.PRENOM']}" />
				<h:outputText id="prenom1"
					value="#{conventionController.convention.etudiant.prenom}" />
			</h:panelGrid>
			<h:panelGrid columnClasses="paginatorData-text"
				rowClasses="paginatorData-text">
				<t:htmlTag value="div" style="height: 10px;" />
				<h:panelGrid columnClasses="paginatorData-text"
					rowClasses="paginatorData-text" columns="3">
					<h:outputLabel value="#{msgs['CONVENTION.ETU.ADRESSE']} *"
						for="mainAddress" />
					<h:inputText id="mainAddress"
						value="#{conventionController.convention.adresseEtudiant}"
						size="50" required="true"
						requiredMessage="#{requiredMessageController.champObligatoire}">
						<a4j:ajax event="blur" />
					</h:inputText>
					<rich:message for="mainAddress">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</rich:message>

					<h:outputLabel value="#{msgs['CONVENTION.ETU.CODEPOSTAL']}"
						for="codePostal" />
					<h:inputText id="codePostal"
						value="#{conventionController.convention.codePostalEtudiant}" />
					<rich:message for="codePostal">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</rich:message>

					<h:outputLabel value="#{msgs['CONVENTION.ETU.COMMUNE']}"
						for="commune" />
					<h:inputText id="commune"
						value="#{conventionController.convention.villeEtudiant}" />
					<rich:message for="commune">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</rich:message>

					<h:outputLabel value="#{msgs['CONVENTION.ETU.PAYS']} *" for="pays" />
					<h:inputText id="pays"
						value="#{conventionController.convention.paysEtudiant}"
						required="true"
						requiredMessage="#{requiredMessageController.champObligatoire}">
						<a4j:ajax event="blur" />
					</h:inputText>
					<rich:message for="pays">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</rich:message>


					<h:outputLabel value="#{msgs['CONVENTION.ETU.TELEPHONE']}"
						for="telephone" />
					<h:inputText id="telephone"
						value="#{conventionController.convention.telEtudiant}" />
					<rich:message for="telephone">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</rich:message>

					<h:outputLabel value="#{msgs['CONVENTION.ETU.TELEPHONE.PORTABLE']}"
						for="telephoneportable" />
					<h:inputText id="telephoneportable"
						value="#{conventionController.convention.telPortableEtudiant}" />
					<rich:message for="telephoneportable">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</rich:message>

					<h:outputLabel value="#{msgs['CONVENTION.ETU.MAILINSTITU']}"
						for="mailinstitu" />
					<h:outputText id="mailinstitu"
						value="#{conventionController.convention.etudiant.mail}" />
					<rich:message for="mailinstitu">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</rich:message>

					<h:outputLabel value="#{msgs['CONVENTION.ETU.MAILPERSO']} *"
						for="mailperso" />
					<h:inputText id="mailperso" required="true"
						value="#{conventionController.convention.courrielPersoEtudiant}"
						size="50" />
					<rich:message for="mailperso">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</rich:message>
				</h:panelGrid>

				<t:htmlTag value="div" style="height:5px;" />

				<h:panelGrid columns="2" styleClass="alignTop"
					rendered="#{not empty conventionController.convention.etudiant}">
					<t:fieldset>
						<legend>
							<h:outputLabel for="affilss" style="font-size:12px;"
								value="#{msgs['CONVENTION.CHOIX.AFFILSS']} * " />
						</legend>
						<h:selectOneRadio id="affilss" layout="pageDirection"
							required="true" styleClass="unbold"
							requiredMessage="#{requiredMessageController.champObligatoire}"
							value="#{conventionController.selAssurance}"
							converter="#{assuranceConverter}">
							<f:selectItems value="#{nomenclatureController.assurances}" />
						</h:selectOneRadio>
						<rich:message for="affilss">
							<ui:include src="../_commun/_messageErrorMarker.xhtml" />
						</rich:message>
					</t:fieldset>
					<t:fieldset style="width:80%;">
						<legend>
							<h:outputLabel for="caisses" style="font-size:12px;"
								value="#{msgs['CONVENTION.CHOIX.CPAM']} * " />
						</legend>
						<h:selectOneRadio id="caisses" layout="pageDirection"
							value="#{conventionController.selCaisseRegime}"
							converter="#{caisseRegimeConverter}" styleClass="unbold">
							<f:selectItems value="#{nomenclatureController.caisseRegimes}" />
						</h:selectOneRadio>
						<rich:message for="caisses">
							<ui:include src="../_commun/_messageErrorMarker.xhtml" />
						</rich:message>
					</t:fieldset>
				</h:panelGrid>

				<rich:panel style="width:700px;" id="panelInscription">
					<f:facet name="header">
						<h:outputText style="font-size:12px;"
							value="#{msgs['CONVENTION.ETAPE1.CHOIXETUDIANT.DEMANDE']}" />
					</f:facet>
					<h:panelGrid columns="2" columnClasses="paginatorData-text"
						rowClasses="paginatorData-text">
						<h:outputText value="#{msgs['CONVENTION.ANNEE']}"
							style="font-weight:bold;" />
						<h:outputText value="#{conventionController.convention.annee}" />
					</h:panelGrid>

					<h:panelGrid columns="2" columnClasses="paginatorData-text"
						rowClasses="paginatorData-text"
						rendered="#{conventionController.blocageCreationEtpOrpheline}">
						<h:graphicImage value="../../media/images/cancel.png"
							alt="#{msgs['GENERAL.WARNING']}"
							title="#{msgs['GENERAL.WARNING']}" />
						<h:outputText
							value="#{msgs['CONVENTION.CREERCONVENTION.ETAPE.NONRATTACHE']}"
							style="color:red;" />
					</h:panelGrid>

					<h:panelGrid columns="2" columnClasses="paginatorData-text"
						rowClasses="paginatorData-text"
						rendered="#{conventionController.blocageAucuneInscription}">
						<h:graphicImage value="../../media/images/cancel.png"
							alt="#{msgs['GENERAL.WARNING']}" title="#{msgs['GENERAL.WARNING']}" />
						<h:outputText
							value="#{msgs['CONVENTION.CREERCONVENTION.ETAPE.AUCUNE_INSCRIPTION_PAYEE']}"
							style="color:red;" />
					</h:panelGrid>
			
					<t:div
						rendered="#{!conventionController.blocageCreationEtpOrpheline
						and !conventionController.blocageAucuneInscription}">

						<t:htmlTag value="div" style="height: 10px;" />

						<t:div rendered="#{!conventionController.etudiantSupUneEtape}">
							<h:panelGrid columns="2" columnClasses="paginatorData-text"
								rowClasses="paginatorData-text">
								<h:outputLabel for="ufr" value="#{msgs['CONVENTION.VOTREUFR']}" />
								<h:outputText id="ufr"
									value="#{conventionController.etudiantRef.thecodeUFR} - #{conventionController.etudiantRef.theUfr}" />
								<h:outputLabel for="etape"
									value="#{msgs['CONVENTION.VOTREETAPE']}" />
								<h:outputText id="etape"
									value="#{conventionController.etudiantRef.theCodeEtape} - #{conventionController.etudiantRef.theEtape}" />
							</h:panelGrid>
							<h:panelGrid columns="2" style="padding:5px;"
								rendered="#{conventionController.etudiantUnElp || conventionController.etudiantSupUnElp}">
								<h:outputLabel for="elp1" value="#{msgs['CONVENTION.ELP']}" />
								<h:panelGrid columnClasses="paginatorData-text"
									rowClasses="paginatorData-text">
									<h:selectOneMenu id="choixElp1"
										value="#{conventionController.selectedCodeElp}"
										required="true"
										requiredMessage="#{requiredMessageController.champObligatoire}">
										<f:selectItem itemValue="" />
										<f:selectItems
											value="#{conventionController.listeELPEtapesSelectItems}" />
										<a4j:ajax event="valueChange"
											listener="#{conventionController.rechargeElp}" render="elp1" />
									</h:selectOneMenu>
									<h:outputText id="elp1"
										value="#{conventionController.etudiantRef.theCodeElp} - #{conventionController.etudiantRef.theLibElp} - #{conventionController.etudiantRef.theCreditECTS} crédit(s)" />
								</h:panelGrid>
							</h:panelGrid>
							<rich:message for="choixElp1">
								<ui:include src="../_commun/_messageErrorMarker.xhtml" />
							</rich:message>
						</t:div>

						<t:div rendered="#{conventionController.etudiantSupUneEtape}">
							<a4j:outputPanel id="ufrs">
								<h:panelGrid columnClasses="paginatorData-text"
									rowClasses="paginatorData-text" columns="2"
									rendered="#{conventionController.choixEtape}">
									<h:outputLabel for="ufr" value="#{msgs['CONVENTION.VOTREUFR']}" />
									<h:outputText
										value="#{conventionController.etudiantRef.thecodeUFR} - #{conventionController.etudiantRef.theUfr}" />
								</h:panelGrid>
							</a4j:outputPanel>
							<h:panelGrid columns="2" columnClasses="paginatorData-text"
								rowClasses="paginatorData-text">
								<h:outputLabel for="etapes"
									value="#{msgs['CONVENTION.VOTREETAPE']}" />
								<h:panelGrid columnClasses="paginatorData-text"
									rowClasses="paginatorData-text" columns="2" id="etapes">
									<h:selectOneMenu id="choixEtape"
										value="#{conventionController.selectedCodeEtape}">
										<f:selectItem itemValue="" />
										<f:selectItems
											value="#{conventionController.listeEtapesEtudiant}" />
										<a4j:ajax event="valueChange"
											listener="#{conventionController.rechargeUfr}"
											render="ufrs,elementPedago,panelElp" />
									</h:selectOneMenu>
									<rich:message for="choixEtape">
										<ui:include src="../_commun/_messageErrorMarker.xhtml" />
									</rich:message>
								</h:panelGrid>
							</h:panelGrid>
							<a4j:outputPanel id="elementPedago">
								<h:panelGrid columnClasses="paginatorData-text"
									rowClasses="paginatorData-text" columns="2"
									rendered="#{conventionController.etudiantUnElp || conventionController.etudiantSupUnElp}">
									<h:outputLabel for="elementPedago"
										value="#{msgs['CONVENTION.ELP']}" />
									<h:outputText
										value="#{conventionController.etudiantRef.theCodeElp} - #{conventionController.etudiantRef.theLibElp} - #{conventionController.etudiantRef.theCreditECTS} crédit(s)" />
								</h:panelGrid>
							</a4j:outputPanel>
							<a4j:outputPanel id="panelElp">
								<h:panelGrid columnClasses="paginatorData-text"
									rowClasses="paginatorData-text" columns="3"
									rendered="#{conventionController.etudiantSupUnElp}">
									<h:outputLabel for="choixElp2"
										value="#{msgs['CONVENTION.ELP']}" />
									<h:selectOneMenu id="choixElp2"
										value="#{conventionController.selectedCodeElp}"
										required="true"
										requiredMessage="#{requiredMessageController.champObligatoire}">
										<f:selectItem itemValue="" />
										<f:selectItems
											value="#{conventionController.listeELPEtapesSelectItems}" />
										<a4j:ajax event="valueChange"
											listener="#{conventionController.rechargeElp}" />
									</h:selectOneMenu>
									<rich:message for="choixElp2">
										<ui:include src="../_commun/_messageErrorMarker.xhtml" />
									</rich:message>
								</h:panelGrid>
							</a4j:outputPanel>
						</t:div>
					</t:div>
					<rich:message for="etape">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</rich:message>
				</rich:panel>

			</h:panelGrid>

			<a4j:outputPanel id="opFCE">
				<h:panelGrid columnClasses="paginatorData-text"
					rowClasses="paginatorData-text" columns="3"
					rendered="#{facesContext.maximumSeverity != null}">
					<h:graphicImage value="../../media/images/arrow_up.png"
						alt="#{msgs['GENERAL.ARROW_UP']}"
						title="#{msgs['GENERAL.ARROW_UP']}" />
					<h:outputText value="#{msgs['FORM.FORMERROR']}" />
					<h:graphicImage value="../../media/images/arrow_up.png"
						alt="#{msgs['GENERAL.ARROW_UP']}"
						title="#{msgs['GENERAL.ARROW_UP']}" />
				</h:panelGrid>
			</a4j:outputPanel>
		</t:div>

		<a4j:commandButton id="modifEtudiant" value="#{msgs['FORM.MODIFIER']}"
			action="#{conventionController.modifierEtudiantDetail}"
			rendered="#{not empty conventionController.convention.etudiant}"
			status="statusModifEtudiant" render="opFCE" />
		<a4j:status name="statusModifEtudiant">
			<f:facet name="start">
				<ui:include src="../_commun/_veuillezPatienter.xhtml" />
			</f:facet>
		</a4j:status>

	</h:panelGrid>

</ui:composition>