<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:t="http://myfaces.apache.org/tomahawk">

	<h:panelGrid>
		<ui:include src="../_commun/_champsObligatoires.xhtml" />
		<h:panelGrid columns="3">
			<h:panelGrid>
				<h:outputLabel value="#{msgs['STRUCTURE.RAISON_SOCIALE']} *"
					for="raisonSociale" />
				<h:panelGrid columns="2">
					<h:graphicImage id="imgInfo"
						alt="#{msgs['INFOSBULLES.RAISON_SOCIALE']}"
						value="../../media/images/information.png">
						<p:tooltip value="#{msgs['INFOSBULLES.RAISON_SOCIALE']}" />
					</h:graphicImage>
					<h:inputText id="raisonSociale" style="text-transform:uppercase;"
						value="#{etablissementController.formStructure.raisonSociale}"
						size="50" maxlength="150" required="true"
						requiredMessage="#{requiredMessageController.champObligatoire}"
						converter="#{sansAccentEnMAJConverter}">
						<p:ajax event="blur" />
					</h:inputText>
				</h:panelGrid>
				<p:message for="raisonSociale">
					<ui:include src="../_commun/_messageErrorMarker.xhtml" />
				</p:message>
				<!-- 				<h:outputLabel value="#{msgs['STRUCTURE.GROUPE']}" for="groupe" /> -->
				<!-- 				<h:inputText id="groupe" style="text-transform:uppercase;" -->
				<!-- 					value="#{etablissementController.formStructure.groupe}" size="50" -->
				<!-- 					maxlength="50" converter="#{sansAccentEnMAJConverter}" /> -->
				<!-- 				<p:message for="groupe"> -->
				<!-- 					<ui:include src="../_commun/_messageErrorMarker.xhtml" /> -->
				<!-- 				</p:message> -->
				<h:outputLabel value="#{msgs['STRUCTURE.EFFECTIF']} *"
					for="effectif" />
				<h:selectOneMenu id="effectif"
					value="#{etablissementController.formStructure.effectif}"
					converter="#{effectifConverter}" required="true"
					requiredMessage="#{requiredMessageController.champObligatoire}">
					<f:selectItem itemValue="" />
					<f:selectItems value="#{nomenclatureController.effectifs}" />
					<p:ajax event="valueChange" />
				</h:selectOneMenu>
				<p:message for="effectif">
					<ui:include src="../_commun/_messageErrorMarker.xhtml" />
				</p:message>
			</h:panelGrid>
			<h:panelGrid columns="3">
				<t:htmlTag value="div" style="width: 25px;" />
				<t:htmlTag value="div"
					style="width: 2px; background-color: #{a4jSkin.panelBorderColor}; height: 125px;" />
				<t:htmlTag value="div" style="width: 25px;" />
			</h:panelGrid>
			<h:panelGrid>
				<h:panelGrid id="olSiret" columns="2">
					<h:outputLabel value="#{msgs['STRUCTURE.NUM_SIRET']}" for="siret" />
					<h:outputLabel value=" *" for="siret"
						rendered="#{(etablissementController.formStructureTmpPays==beanUtils.france || etablissementController.formStructureTmpPays.cog==beanUtils.cogFrance)
						and etablissementController.formStructureTmpTypeStructure.siretObligatoire}" />
				</h:panelGrid>
				<h:panelGrid columns="2">
					<h:graphicImage id="infoNumsiret"
						alt="#{msgs['INFOSBULLES.NUMERO_SIRET']}"
						value="../../media/images/information.png">
						<p:tooltip value="#{msgs['INFOSBULLES.NUMERO_SIRET']}" />
					</h:graphicImage>
					<h:inputText id="siret"
						value="#{etablissementController.formStructure.numeroSiret}"
						size="20" maxlength="14"
						required="#{(etablissementController.formStructureTmpPays==beanUtils.france || etablissementController.formStructureTmpPays.cog==beanUtils.cogFrance)
						and etablissementController.formStructureTmpTypeStructure.siretObligatoire}"
						requiredMessage="#{requiredMessageController.champObligatoire}"
						validatorMessage="#{requiredMessageController.numeroSiretNonValide}"
						readonly="#{sessionController.pageAuthorized and not sessionController.adminPageAuthorized}">
						<f:validator binding="#{numSiretValidator}" />
						<p:ajax event="blur" />
					</h:inputText>
				</h:panelGrid>
				<p:message for="siret">
					<ui:include src="../_commun/_messageErrorMarker.xhtml" />
				</p:message>
				<p:commandButton
					action="#{welcomeController.nousContacterModifSiret}"
					rendered="#{sessionController.pageAuthorized and sessionController.adminPageAuthorized and not empty sessionController.currentManageStructure and
			(etablissementController.formStructureTmpPays==beanUtils.france || etablissementController.formStructureTmpPays.cog==beanUtils.cogFrance)}"
					value="#{msgs['STRUCTURE.DEMANDE_MODIFSIRET']}"
					oncomplete="PF('nousContacter').show();" update="nousContacter" />
				<h:outputText value="#{msgs['STRUCTURE.NUM_SIRET.AIDE']}"
					escape="false" />
				<p:outputPanel id="opSiretOblig">
					<h:panelGrid columns="2"
						rendered="#{(etablissementController.formStructureTmpPays==beanUtils.france || etablissementController.formStructureTmpPays.cog==beanUtils.cogFrance)
						and etablissementController.formStructureTmpTypeStructure.siretObligatoire}">
						<h:graphicImage id="arrow"
							value="../../media/images/arrow_turn_up.png"
							alt="#{msgs['GENERAL.ARROW_UP']}"
							title="#{msgs['GENERAL.ARROW_UP']}" />
						<h:outputText value="#{msgs['STRUCTURE.NUM_SIRET.OBLIGATOIRE']}" />
					</h:panelGrid>
				</p:outputPanel>
				<h:panelGrid>
					<h:outputLabel value="#{msgs['STRUCTURE.TYPE_STRUCTURE']} *"
						for="typeStructure" />
					<h:selectOneMenu id="typeStructure"
						value="#{etablissementController.formStructureTmpTypeStructure}"
						converter="#{typeStructureConverter}" required="true"
						valueChangeListener="#{etablissementController.valueTypeStructureChanged}"
						requiredMessage="#{requiredMessageController.champObligatoire}">
						<f:selectItem itemValue="" />
						<f:selectItems value="#{nomenclatureController.typesStructure}" />
						<p:ajax event="valueChange"
							update="opStatutJuridique, siret, olSiret" />
					</h:selectOneMenu>
					<p:message for="typeStructure">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</p:message>
					<p:outputPanel id="opStatutJuridique">
						<h:panelGrid
							rendered="#{!empty etablissementController.statutsJuridiquesListening
							and !empty etablissementController.formStructureTmpTypeStructure}">
							<h:outputLabel value="#{msgs['STRUCTURE.STATUT_JURIDIQUE']} *"
								for="statutJuridique" />
							<h:selectOneMenu id="statutJuridique"
								value="#{etablissementController.formStructureTmpStatutJuridique}"
								converter="#{statutJuridiqueConverter}" required="true"
								requiredMessage="#{requiredMessageController.champObligatoire}">
								<f:selectItem itemValue="" />
								<f:selectItems
									value="#{etablissementController.statutsJuridiquesListening}" />
								<p:ajax event="blur" />
							</h:selectOneMenu>
							<p:message for="statutJuridique">
								<ui:include src="../_commun/_messageErrorMarker.xhtml" />
							</p:message>
						</h:panelGrid>
					</p:outputPanel>
				</h:panelGrid>
			</h:panelGrid>
		</h:panelGrid>
		<h:panelGrid columns="2">
			<h:outputLabel value="#{msgs['STRUCTURE.CODE_NAF']} *" for="ape" />
			<h:outputText value="#{msgs['STRUCTURE.CODE_NAF.AIDE']}"
				escape="false" />
		</h:panelGrid>
		<h:panelGrid columns="4">
			<h:graphicImage id="infoApe" alt="#{msgs['INFOSBULLES.CODE_APE']}"
				value="../../media/images/information.png">
				<p:tooltip value="#{msgs['INFOSBULLES.CODE_APE']}" />
			</h:graphicImage>
			<h:inputText id="ape" style="text-transform:uppercase;"
				value="#{etablissementController.formStructureTmpNafN5.code}"
				validatorMessage="#{requiredMessageController.codeNafNonValide}"
				valueChangeListener="#{etablissementController.valueCodeNafChanged}"
				converter="#{codNafN5Converter}" size="20" maxlength="6">
				<f:validator binding="#{codeNAFValidator}" />
				<p:ajax event="blur" update="opLibelleAPE" />
			</h:inputText>
			<t:htmlTag value="div" style="width: 20px;" />
			<p:outputPanel id="opLibelleAPE">
				<h:panelGrid columns="2">
					<h:graphicImage
						rendered="#{!empty etablissementController.formStructureTmpNafN5.libelle}"
						value="../../media/images/tick.png" alt="Valide" title="Valide" />
					<h:outputText
						rendered="#{!empty etablissementController.formStructureTmpNafN5.libelle}"
						value="#{etablissementController.formStructureTmpNafN5.libelle}" />
				</h:panelGrid>
			</p:outputPanel>
		</h:panelGrid>
		<p:message for="ape">
			<ui:include src="../_commun/_messageErrorMarker.xhtml" />
		</p:message>
		<t:div id="arrows">
			<h:panelGrid columns="4"
				rendered="#{!etablissementController.codeNafObligatoire ||
				(etablissementController.formStructureTmpPays!=beanUtils.france and etablissementController.formStructureTmpPays.cog!=beanUtils.cogFrance)}">
				<t:htmlTag value="div" style="width: 20px;" />
				<h:graphicImage
					value="../../media/images/arrow_turn_up_and_down.png"
					alt="#{msgs['GENERAL.ARROW_UP_DOWN']}"
					title="#{msgs['GENERAL.ARROW_UP_DOWN']}" />
				<t:htmlTag value="div" style="width: 5px;" />
				<h:outputText value="#{msgs['STRUCTURE.CODE_NAF.OBLIGATOIRE']}" />
			</h:panelGrid>
		</t:div>
		<h:panelGrid id="olActprinc" columns="2">
			<h:outputLabel value="#{msgs['STRUCTURE.ACTIVITE_PRINCIPALE']}"
				for="actprinc" />
			<h:outputLabel value=" *" for="actprinc"
				rendered="#{!etablissementController.codeNafObligatoire ||
			(etablissementController.formStructureTmpPays!=beanUtils.france and etablissementController.formStructureTmpPays.cog!=beanUtils.cogFrance)}" />
		</h:panelGrid>
		<h:panelGrid>
			<h:inputTextarea id="actprinc"
				value="#{etablissementController.formStructure.activitePrincipale}"
				width="400" height="200" />
			<p:message for="actprinc">
				<ui:include src="../_commun/_messageErrorMarker.xhtml" />
			</p:message>
		</h:panelGrid>
		<h:outputText value="#{msgs['STRUCTURE.ADRESSE']}" />
		<h:panelGrid columns="3">
			<h:panelGrid>
				<h:outputLabel value="#{msgs['STRUCTURE.VOIE']} *" for="voie" />
				<h:panelGrid>
					<h:inputText id="voie"
						value="#{etablissementController.formStructure.voie}" size="50"
						maxlength="200" required="true"
						requiredMessage="#{requiredMessageController.champObligatoire}">
						<p:ajax event="blur" />
					</h:inputText>
					<p:message for="voie">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</p:message>
				</h:panelGrid>
				<h:outputLabel value="#{msgs['STRUCTURE.BATIMENT_RESIDENCE']} "
					for="batimentResidence" />
				<h:panelGrid>
					<h:inputText id="batimentResidence"
						value="#{etablissementController.formStructure.batimentResidence}"
						size="50" maxlength="200">
					</h:inputText>
					<p:message for="batimentResidence">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</p:message>
				</h:panelGrid>
				<h:outputLabel value="#{msgs['STRUCTURE.CEDEX']} " for="cedex" />
				<h:panelGrid>
					<h:inputText id="cedex"
						value="#{etablissementController.formStructure.libCedex}"
						size="30" maxlength="28"
						requiredMessage="#{requiredMessageController.champObligatoire}" />
					<p:message for="cedex">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</p:message>
				</h:panelGrid>
			</h:panelGrid>
			<h:panelGrid columns="3">
				<t:htmlTag value="div" style="width: 25px;" />
				<t:htmlTag value="div"
					style="width: 2px; background-color: #{a4jSkin.panelBorderColor}; height: 125px;" />
				<t:htmlTag value="div" style="width: 25px;" />
			</h:panelGrid>
			<h:panelGrid>
				<p:outputPanel id="opCodePostal">
					<h:panelGrid
						rendered="#{!sessionController.recupererCommunesDepuisApogee ||
				(etablissementController.formStructureTmpPays!=beanUtils.france and etablissementController.formStructureTmpPays.cog!=beanUtils.cogFrance
				and sessionController.recupererCommunesDepuisApogee)}">
						<h:panelGrid columns="2">
							<h:outputLabel value="#{msgs['STRUCTURE.CODE_POSTAL']} "
								for="codePostal" />
							<h:outputLabel value=" *" for="codePostal"
								rendered="#{!sessionController.recupererCommunesDepuisApogee and 
								(etablissementController.formStructureTmpPays==beanUtils.france || etablissementController.formStructureTmpPays.cog==beanUtils.cogFrance)}" />
						</h:panelGrid>
						<h:inputText id="codePostal"
							value="#{etablissementController.formStructureTmpCodePostal}"
							size="20" maxlength="10"
							requiredMessage="#{requiredMessageController.champObligatoire}"
							required="#{!sessionController.recupererCommunesDepuisApogee and 
								(etablissementController.formStructureTmpPays==beanUtils.france || etablissementController.formStructureTmpPays.cog==beanUtils.cogFrance)}">
							<p:ajax event="blur" />
						</h:inputText>
						<p:message for="codePostal">
							<ui:include src="../_commun/_messageErrorMarker.xhtml" />
						</p:message>
					</h:panelGrid>
					<h:panelGrid
						rendered="#{(etablissementController.formStructureTmpPays==beanUtils.france || etablissementController.formStructureTmpPays.cog==beanUtils.cogFrance)
				and sessionController.recupererCommunesDepuisApogee}">
						<h:panelGrid>
							<h:outputLabel value="#{msgs['STRUCTURE.CODE_POSTAL']} *"
								for="dynaCodePostal" />
							<h:inputText id="dynaCodePostal"
								value="#{etablissementController.formStructureTmpCodePostal}"
								size="5" maxlength="5" required="true"
								requiredMessage="#{requiredMessageController.champObligatoire}"
								validatorMessage="#{requiredMessageController.codePostalNonValide}"
								valueChangeListener="#{etablissementController.valueCodePostalChanged}">
								<f:validator binding="#{codePostalValidator}" />
								<p:ajax event="valueChange" update="opDynaCommune" />
							</h:inputText>
						</h:panelGrid>
						<p:message for="dynaCodePostal" />
					</h:panelGrid>
				</p:outputPanel>
				<h:outputLabel value="#{msgs['STRUCTURE.COMMUNE']} *" for="commune" />
				<p:outputPanel id="opCommune">
					<h:panelGrid
						rendered="#{!sessionController.recupererCommunesDepuisApogee ||
				(etablissementController.formStructureTmpPays!=beanUtils.france and etablissementController.formStructureTmpPays.cog!=beanUtils.cogFrance
				and sessionController.recupererCommunesDepuisApogee)}">
						<h:inputText id="commune" style="text-transform:uppercase;"
							value="#{etablissementController.formStructure.commune}"
							size="50" maxlength="200" required="true"
							converter="#{sansAccentEnMAJConverter}"
							requiredMessage="#{requiredMessageController.champObligatoire}">
							<p:ajax event="blur" />
						</h:inputText>
						<p:message for="commune">
							<ui:include src="../_commun/_messageErrorMarker.xhtml" />
						</p:message>
					</h:panelGrid>
					<h:panelGrid
						rendered="#{(etablissementController.formStructureTmpPays==beanUtils.france || etablissementController.formStructureTmpPays.cog==beanUtils.cogFrance)
				and sessionController.recupererCommunesDepuisApogee}">
						<p:outputPanel id="opDynaCommune">
							<h:selectOneMenu id="dynaCommune"
								value="#{etablissementController.formStructureTmpCommuneDTO.codeCommune}"
								required="true"
								requiredMessage="#{requiredMessageController.champObligatoire}">
								<f:selectItem itemValue="" />
								<f:selectItems
									value="#{etablissementController.communesListening}" />
								<p:ajax event="valueChange" />
							</h:selectOneMenu>
							<p:message for="dynaCommune">
								<ui:include src="../_commun/_messageErrorMarker.xhtml" />
							</p:message>
						</p:outputPanel>
						<!-- 							<p:ajaxStatus for="dynaR"> -->
						<!-- 								<f:facet name="start"> -->
						<!-- 									<h:graphicImage value="../../media/images/ajax_process.gif" /> -->
						<!-- 								</f:facet> -->
						<!-- 							</p:ajaxStatus> -->
					</h:panelGrid>
				</p:outputPanel>
				<t:panelGrid>
					<h:outputLabel value="#{msgs['STRUCTURE.PAYS']}" for="paysNC" />
					<h:panelGrid columns="3">
						<p:outputPanel id="opFlagNC">
							<t:htmlTag value="div" style="width: 16px;"
								rendered="#{empty etablissementController.formStructureTmpPays}" />
							<h:graphicImage id="flagNC"
								rendered="#{not empty etablissementController.formStructureTmpPays and not empty etablissementController.formStructureTmpPays.iso2}"
								value="../../media/images/flags/#{etablissementController.formStructureTmpPays.iso2}.png"
								alt="#{msgs['GENERAL.MINI_DRAPEAU']}"
								title="#{etablissementController.formStructureTmpPays.libelle}" />
						</p:outputPanel>
						<t:htmlTag value="div" style="width:5px;" />
						<h:selectOneMenu id="paysNC" required="true"
							requiredMessage="#{requiredMessageController.champObligatoire}"
							value="#{etablissementController.formStructureTmpPays}"
							converter="#{paysConverter}">
							<p:ajax event="change"
								update="opFlagNC, opSiretOblig, opCodePostal, opCommune, olSiret, siret, arrows, olActprinc" />
							<f:selectItem itemValue="" />
							<f:selectItems value="#{nomenclatureController.pays}" />
						</h:selectOneMenu>
					</h:panelGrid>
					<p:message for="paysNC"/>
				</t:panelGrid>
			</h:panelGrid>
		</h:panelGrid>
		<h:panelGrid columns="3">
			<h:panelGrid>
				<h:panelGrid columns="2">
					<h:outputLabel value="#{msgs['STRUCTURE.MAIL']} " for="mail" />
					<h:outputText value="#{msgs['CONTACT.MAIL.AIDE']}" escape="false" />
				</h:panelGrid>
				<h:panelGrid>
					<h:inputText id="mail"
						value="#{etablissementController.formStructure.mail}" size="50"
						validatorMessage="#{requiredMessageController.adresseMailNonValide}"
						maxlength="50">
						<f:validator binding="#{mailValidator}" />
						<p:ajax event="blur" />
					</h:inputText>
					<p:message for="mail">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</p:message>
				</h:panelGrid>
				<h:panelGrid columns="2">
					<h:outputLabel value="#{msgs['STRUCTURE.SITEWEB']} " for="siteWeb" />
					<h:outputText value="#{msgs['STRUCTURE.SITEWEB.AIDE']}"
						escape="false" />
				</h:panelGrid>
				<h:panelGrid>
					<h:inputText id="siteWeb"
						value="#{etablissementController.formStructure.siteWeb}" size="50"
						validatorMessage="#{requiredMessageController.siteWebNonValide}"
						maxlength="200">
						<f:validator binding="#{siteWebValidator}" />
						<p:ajax event="blur" />
					</h:inputText>
					<p:message for="siteWeb">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</p:message>
				</h:panelGrid>
			</h:panelGrid>
			<h:panelGrid columns="3">
				<t:htmlTag value="div" style="width: 25px;" />
				<t:htmlTag value="div"
					style="width: 2px; background-color: #{a4jSkin.panelBorderColor}; height: 125px;" />
				<t:htmlTag value="div" style="width: 25px;" />
			</h:panelGrid>
			<h:panelGrid>
				<h:outputLabel value="#{msgs['STRUCTURE.TELEPHONE']} *"
					for="telephone" />
				<h:panelGrid>
					<h:inputText id="telephone"
						value="#{etablissementController.formStructure.telephone}"
						size="20" maxlength="20" required="true"
						requiredMessage="#{requiredMessageController.champObligatoire}">
						<p:ajax event="blur" />
					</h:inputText>
					<p:message for="telephone">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</p:message>
				</h:panelGrid>
				<h:outputLabel value="#{msgs['STRUCTURE.FAX']} " for="fax" />
				<h:panelGrid>
					<h:inputText id="fax"
						value="#{etablissementController.formStructure.fax}" size="20"
						maxlength="20" />
					<p:message for="fax">
						<ui:include src="../_commun/_messageErrorMarker.xhtml" />
					</p:message>
				</h:panelGrid>
			</h:panelGrid>
		</h:panelGrid>
	</h:panelGrid>
</ui:composition>