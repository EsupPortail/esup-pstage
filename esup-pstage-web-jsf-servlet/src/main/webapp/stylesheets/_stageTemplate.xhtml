<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:p="http://primefaces.org/ui">

	<h:head>
		<f:facet name="first">
			<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
			<meta content='text/html; charset=UTF-8' http-equiv="Content-Type" />
		</f:facet>
		<title><h:outputText value="#{applicationService.name}" /></title>
		<link rel="stylesheet" type="text/css"
			  href="#{sessionController.mediaPath}/style/main.css" />
	</h:head>
	<f:view locale="fr">
		<h:body>
			<f:event type="preRenderView" listener="#{sessionController.resetCurrentPage}"/>
			<p:dialog widgetVar="statusDialog" modal="true" draggable="false" closable="false" resizable="false" showHeader="false">
				<ui:include src="/stylesheets/_commun/_veuillezPatienter.xhtml" />
			</p:dialog>
            <p:ajaxExceptionHandler type="javax.faces.application.ViewExpiredException"
                                    update="exceptionDialog"
                                    onexception="PF('exceptionDialog').show();" />

            <p:ajaxExceptionHandler type="java.lang.NullPointerException"
                                    update="exceptionDialog"
                                    onexception="PF('exceptionDialog').show();" />

            <p:dialog id="exceptionDialog" header="Exception '#{pfExceptionHandler.type}' occured!" widgetVar="exceptionDialog"
                      height="500px">
                Message:  <br/>
                StackTrace: <h:outputText value="#{pfExceptionHandler.formattedStackTrace}" escape="false" /> <br />

                <p:button onclick="document.location.href = document.location.href;"
                          value="Reload!"
                          rendered="#{pfExceptionHandler.type == 'javax.faces.application.ViewExpiredException'}" />
            </p:dialog>

			<ui:insert name="sidebar" />
			<ui:insert name="topbar" />
			<t:div id="MAIN_CONTENT">
				<ui:insert name="content" />
			</t:div>
		</h:body>
	</f:view>
</html>